Using TensorFlow backend.
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
/bigdata1/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
/home/ml1323/project/robert_data/DISFA/kfold/2
Traceback (most recent call last):
  File "train_deep_coder_disfa.py", line 44, in <module>
    w_1 = args.warming / 50
  File "/bigdata1/homedirs/ml1323/project/robert_code/EmoData/provider_back.py", line 17, in flow_from_hdf5
    f = h5py.File(path_to_file, 'r')
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 269, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 99, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 78, in h5py.h5f.open
OSError: Unable to open file (file read failed: time = Sat Apr 21 02:02:52 2018
, filename = '/home/ml1323/project/robert_data/DISFA/kfold/2', file descriptor = 5, errno = 21, error message = 'Is a directory', buf = 0x7fffb55ea6c0, total read size = 8, bytes this sub-read = 8, bytes actually read = 18446744073709551615, offset = 0)
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Generating filenames
img_shape (160, 240, 1)
label_shape (1, 2)
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
shape before flatten:  [10, 15, 16]
shape after flatten:  (?, ?) 2400
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/transform/_warps.py:84: UserWarning: The default mode, 'constant', will be changed to 'reflect' in skimage 0.15.
  warn("The default mode, 'constant', will be changed to 'reflect' in "
2018-06-20 10:09:17.189942: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-20 10:09:28.957715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-20 10:09:29.155527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-20 10:09:29.369199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-20 10:09:29.598532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-20 10:09:29.599177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-20 10:09:29.599268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-20 10:09:29.599278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-20 10:09:29.599283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-20 10:09:29.599287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-20 10:09:29.599291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-20 10:09:29.599307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-06-20 10:09:29.599313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-06-20 10:09:29.599318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-06-20 10:09:29.599323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
280
14.0
14
['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame749.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1616.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1416.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1312.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1984.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2381.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1104.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2752.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame746.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2399.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame259.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame12.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame79.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame288.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame159.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame18.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame111.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame107.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame326.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame58.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1418.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1284.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame808.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1875.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2765.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1607.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1285.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame52.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1416.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1520.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1036.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame344.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame314.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame884.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1789.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1071.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame267.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1223.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame302.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1190.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2712.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1118.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1029.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1862.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1210.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1250.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1086.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2361.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame141.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame229.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame527.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame265.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame496.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame547.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame543.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame155.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame472.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2431.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1316.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2522.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame871.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame840.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame175.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2183.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame863.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2149.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame475.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame452.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame60.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1735.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1745.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame237.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame583.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame345.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame528.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1615.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2008.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1012.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1234.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1326.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2087.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1979.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1919.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2427.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame974.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame525.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame644.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame261.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame515.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame510.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame563.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame198.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame562.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame637.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3226.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1907.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame987.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1909.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1002.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2600.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3229.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2804.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1964.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3049.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame609.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame356.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame900.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame861.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame803.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame518.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame911.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame492.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1076.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame394.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame593.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2671.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame391.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2172.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame380.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2684.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1894.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1759.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2384.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame782.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame790.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame526.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame13.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame818.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame530.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame237.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame457.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame74.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame494.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1127.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1606.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame48.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1449.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame543.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2470.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1596.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame50.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1095.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1838.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame510.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame521.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame198.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame302.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame439.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame318.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame469.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame299.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2767.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2571.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame487.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame480.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2398.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame718.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1471.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2865.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1156.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame387.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame405.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame1298.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame841.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame980.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame941.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame888.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame669.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame404.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame955.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame699.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2135.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1704.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2936.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1558.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1234.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2566.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame270.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1813.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1408.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame134.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame231.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame61.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame588.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame918.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame674.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame12.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame913.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame936.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1288.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1866.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2417.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1587.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2159.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2287.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2199.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame453.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2761.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2087.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame605.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame533.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame207.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame500.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame196.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame362.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame530.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame174.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame398.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame311.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame905.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2727.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1461.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1766.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1273.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2285.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame899.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame700.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2597.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame394.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame752.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame169.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame181.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame574.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame696.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame568.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame247.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame656.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame195.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2644.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2495.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2265.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1994.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1642.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame506.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2367.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame626.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2455.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1149.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1175.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame241.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame841.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1162.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame245.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame786.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame369.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1181.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame742.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1896.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1930.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1996.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2365.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame642.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2646.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2380.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1409.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2276.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2465.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame532.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame591.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame268.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame321.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame307.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame97.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame42.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame318.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame95.jpg']
Manipulating image data to be right shape
2018-06-20 10:09:57.444050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-06-20 10:09:57.444090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-06-20 10:09:57.444094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-06-20 10:09:57.444098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
Norm setting not recognized.
========================================================================================
initial weights:  [[[-0.00052895 -0.01783199]]

 [[-0.01874407 -0.0061412 ]]

 [[ 0.0267017   0.00284167]]

 ...

 [[-0.02451465 -0.02777683]]

 [[-0.02862645 -0.02552016]]

 [[ 0.0030342  -0.00415294]]] [[0.9957031 1.0766786]]
weights from vae :  [array([[[-0.11118731,  0.03385485]],

       [[-0.06090746, -0.12547305]],

       [[ 0.20255615,  0.05930348]],

       ...,

       [[-0.1339994 ,  0.01380888]],

       [[ 0.15366611,  0.01848035]],

       [[-0.0925079 , -0.13779806]]], dtype=float32), array([[ 0.00052689, -0.00052688]], dtype=float32)]
updated weights from vae:  [[[-0.11118731  0.03385485]]

 [[-0.06090746 -0.12547305]]

 [[ 0.20255615  0.05930348]]

 ...

 [[-0.1339994   0.01380888]]

 [[ 0.15366611  0.01848035]]

 [[-0.0925079  -0.13779806]]] [[ 0.00052689 -0.00052688]]
========================================================================================
>>>> model_file1:  None
Done initializing, starting training.
Iteration 100
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 1 0 0 0 1 1 0 0 1 0 1 0 1 0 0 1 1 0 1 0 0 0
 1 1 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 1 1 0 0 1 0 0 0 0 0 1 0 1 1 0
 1 0 0 1 0 1 1 0 1 0 1 0 1 1 1 1 1 0 1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 1 0 0
 0 1 0 0 1 1 0 1 1 0 1 0 1 0 1 0 1 1 1 1 1 1 0 0 0 0 0 0 1]
y_lab: 
[0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0
 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0
 1 0 0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0
 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 0 1]
        0  avr.
ICC  0.62  0.62
PCC  0.62  0.62
RMSE 0.44  0.44
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.79  0.79

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 1 0 1 0 0 1 1 0 0 0 1 0 1 0 1 0 1
 0 1 1 0 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1
 1 0 0 1 1 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0 0 1 0 0 0 0 1 1
 0 0 1 1 1 1 0 1 0 1 0 0 1 0 0 0 1 0 1 1 0 0 1 0 0 1 0 1 0]
y_lab: 
[1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1
 0 0 1 0 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1
 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1
 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0]
        0  avr.
ICC  0.73  0.73
PCC  0.73  0.73
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.84  0.84

====================================================================================
Iteration 200
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 1 0 1 0 1 0 1 0 1 0 0 1 1 1 0 0 0 0
 1 1 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 1 1 0 0 1 0 0 0 0 0 1 1 0 0 1
 0 1 1 0 1 0 0 1 0 1 0 1 1 1 1 1 0 1 0 1 0 0 1 0 1 0 0 0 0 0 1 0 0 0 1 0 0
 0 0 1 1 0 0 1 1 1 0 1 1 0 1 0 0 1 1 1 1 1 0 1 0 0 0 0 1 0]
y_lab: 
[1 0 1 0 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0
 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1
 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0
 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 1 0 1 0]
        0  avr.
ICC  0.62  0.62
PCC  0.62  0.62
RMSE 0.44  0.44
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.79  0.79

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 1 0 1 0 1 0 0 0 1 0 1 0 1 0 1
 0 1 1 1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 1 0 1
 0 1 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 0 0 1 0 0 0 1 0
 1 0 1 1 1 0 1 1 0 0 1 1 0 0 0 0 1 0 1 0 1 0 1 0 0 0 1 0 1]
y_lab: 
[0 1 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0 1
 0 1 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0
 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 1 0 1]
        0  avr.
ICC  0.75  0.75
PCC  0.75  0.75
RMSE 0.37  0.37
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.85  0.85

====================================================================================
Iteration 300
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 1 0 0 0 1 0 1 1 0 1 0 0 1 0 0 1 0 0 1 0 0 1
 0 1 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 1 1 0 1 0 0 0 0 0 0 1 0 1 1 0
 0 1 0 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 0 1 0 0 0 1 0 1 0 0 0 0 1 0 0 0 0 1 0
 0 1 0 0 1 1 0 1 1 1 0 0 1 1 0 0 1 1 1 1 1 0 1 0 0 0 0 0 1]
y_lab: 
[0 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1
 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0
 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0
 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 0 1]
        0  avr.
ICC  0.64  0.64
PCC  0.64  0.64
RMSE 0.43  0.43
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.80  0.80

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0 1 0 0 1 0 0 0 1 0 1 0 1 0
 1 1 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 0 0 1 0 0 1 0 0
 1 1 0 1 0 1 0 0 1 1 0 1 0 0 0 0 1 0 1 0 1 1 0 0 0 0 1 1 0]
y_lab: 
[0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0
 1 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 1 0 1 0 1 0 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0
 1 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0]
        0  avr.
ICC  0.76  0.76
PCC  0.76  0.76
RMSE 0.36  0.36
MAE  0.13  0.13
ACC  0.87  0.87
F1-b 0.85  0.85

====================================================================================
Iteration 400
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 1 0 0 1 0 0 1 0 1 1 0 0 1 0 0 0 1 1 0 0 0 1
 0 1 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 1 1 1 0 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 1
 1 0 1 0 0 1 1 0 0 1 1 0 1 1 1 1 0 1 1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 1 0
 0 1 0 0 1 0 1 1 1 0 1 1 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 1 0]
y_lab: 
[0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1
 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1
 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 0
 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0]
        0  avr.
ICC  0.62  0.62
PCC  0.62  0.62
RMSE 0.44  0.44
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.79  0.79

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0 0 1 0 1 0 0 0 1 1 0 0 1 0
 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 0 1 0 0 0 0 0 0 0 1 0 1 0
 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 0 1 0 0 0 1 0 1
 0 1 0 1 0 0 1 1 0 1 0 0 1 0 0 0 1 0 1 0 1 0 1 0 0 0 1 0 1]
y_lab: 
[0 1 1 0 0 1 1 0 1 0 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0
 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0
 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1
 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1]
        0  avr.
ICC  0.78  0.78
PCC  0.78  0.78
RMSE 0.35  0.35
MAE  0.12  0.12
ACC  0.88  0.88
F1-b 0.86  0.86

====================================================================================
Iteration 500
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 1 1 0 0 1 1 0 1 0 0 0 0 1 0 1 0 0 1
 0 1 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 1 1 0 1 1 0 1 1 0 0 0 0 0 1 0 0 1 0 1
 0 1 0 1 0 1 0 1 1 0 0 1 1 1 1 1 0 1 1 0 0 0 1 0 1 0 0 0 0 0 1 0 0 0 1 0 0
 0 0 1 0 1 0 1 1 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 0 0 0 0 0 1]
y_lab: 
[0 1 1 0 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1
 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1
 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0
 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1]
        0  avr.
ICC  0.62  0.62
PCC  0.62  0.62
RMSE 0.44  0.44
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.79  0.79

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 1 0 1 0 0 1 0 1 0 0 1 0 0 1 0 1 1
 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 0 0 1 0 0 0 0 0 0 1 0 1 0
 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 0 0 1 0 1
 0 1 0 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 0 1 0 1 0 0 0 0 1 0 1]
y_lab: 
[1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1
 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 1 0
 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1
 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 0 1]
        0  avr.
ICC  0.78  0.78
PCC  0.78  0.78
RMSE 0.35  0.35
MAE  0.12  0.12
ACC  0.88  0.88
F1-b 0.86  0.86

====================================================================================
Iteration 600
y_hat: 
[1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 1 1 0 0 1 0 1 0 1 0 0 0 1 1 0 0 0 1
 0 1 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 1 0 1 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 1
 1 0 1 0 0 1 0 1 1 0 0 1 1 1 1 1 1 0 1 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 0 1 0
 0 1 0 0 1 0 1 1 1 0 1 0 1 0 1 1 0 1 1 1 1 1 0 0 0 0 0 1 0]
y_lab: 
[1 0 0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 1 0 0 1 1
 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1
 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1
 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0]
        0  avr.
ICC  0.63  0.63
PCC  0.63  0.63
RMSE 0.43  0.43
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.80  0.80

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 1 0 0 1 0 1 0 0 0 1 1 0 1 0 0
 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 1 1 0
 0 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 0 1 0 0 0 1 0 1
 0 0 1 0 1 1 0 0 1 1 0 0 1 0 0 1 0 0 1 0 1 0 1 0 0 1 0 0 1]
y_lab: 
[1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 0 1 1 0 1 0 0
 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 0
 0 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1
 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1]
        0  avr.
ICC  0.78  0.78
PCC  0.78  0.78
RMSE 0.35  0.35
MAE  0.12  0.12
ACC  0.88  0.88
F1-b 0.86  0.86

====================================================================================
Iteration 700
y_hat: 
[0 1 0 0 0 0 0 0 0 0 0 0 1 0 1 1 0 0 0 1 1 0 1 0 1 0 1 0 0 0 1 0 1 0 0 0 1
 0 1 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 1 1 0 1 1 1 0 1 0 0 0 0 0 0 1 0 1 0 1
 0 1 0 1 1 0 0 1 1 0 0 1 1 1 1 1 0 1 0 1 0 0 0 1 0 1 0 0 0 0 0 1 0 0 1 0 0
 0 1 0 1 0 1 0 1 1 0 1 0 1 1 0 1 0 1 1 1 1 0 1 0 0 0 0 1 0]
y_lab: 
[0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1
 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1
 0 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0
 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0]
        0  avr.
ICC  0.63  0.63
PCC  0.63  0.63
RMSE 0.43  0.43
MAE  0.19  0.19
ACC  0.81  0.81
F1-b 0.80  0.80

------------------------------------------------------------------------------------
y_hat: 
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 1 0 0 1 1 0 0 1 0 0 0 1 0 1 1 0 0
 1 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 1 0
 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 0 0 1 0 0 0 1 1
 0 1 0 1 0 1 0 1 0 0 1 0 1 0 0 0 1 0 1 1 0 0 1 0 0 1 0 0 1]
y_lab: 
[0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 1 0 0
 1 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0
 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1
 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1]
        0  avr.
ICC  0.78  0.78
PCC  0.78  0.78
RMSE 0.35  0.35
MAE  0.12  0.12
ACC  0.88  0.88
F1-b 0.86  0.86

====================================================================================
Iteration 800
y_hat: 
[1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 1 1 0 0 1 0 1 0 1 1 0 1 0 0 0 0 1 0 1 0 0 0
 1 1 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 1 1 0 1 1 0 0 0 0 0 0 1 1 0 0 1
 1 0 0 1 1 0 1 0 0 1 1 0 1 1 1 1 1 0 0 1 0 1 1 0 0 1 1 1 1 0 0 1 0 1 1 0 0
 0 0 1 0 1 1 0 1 1 0 1 0 1 0 1 0 1 1 1 1 1 1 0 1 0 0 0 1 0]
y_lab: 
[1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 0
 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1
 1 0 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0
 1 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0]
        0  avr.
ICC  0.74  0.74
PCC  0.74  0.74
RMSE 0.36  0.36
MAE  0.13  0.13
ACC  0.87  0.87
F1-b 0.88  0.88

------------------------------------------------------------------------------------
y_hat: 
[0 1 1 0 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 0 0 1 0 1 0 1 1
 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0 1 0 1 0
 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0
 1 1 0 1 0 1 0 1 0 1 0 0 1 0 0 1 0 0 1 1 0 1 0 0 0 1 0 1 0]
y_lab: 
[0 1 1 0 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1
 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0
 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0
 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 900
y_hat: 
[0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 1 0 1 1 0 1 0 1 0 1 0 0 1 0 0 1 0 1 0 0 0 0
 1 1 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 1 1 0 1 1 1 0 1 0 0 0 0 0 0 1 0 1 0 1
 0 1 1 0 1 0 1 0 1 0 0 1 1 1 1 1 1 0 1 0 1 0 1 0 0 1 1 1 1 0 1 0 0 0 1 0 0
 0 1 0 0 1 1 0 1 1 1 0 1 0 0 1 1 0 1 1 1 1 1 0 1 0 0 0 1 0]
y_lab: 
[0 1 0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0
 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1
 0 1 1 0 1 0 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 1 0 0
 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0]
        0  avr.
ICC  0.73  0.73
PCC  0.73  0.73
RMSE 0.37  0.37
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.87  0.87

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 0 1 0 0 1 0 1 0
 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0 0 1
 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0
 1 0 1 0 1 1 0 1 0 0 1 0 1 0 0 1 0 1 0 1 0 0 1 0 0 1 0 1 0]
y_lab: 
[1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0
 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1
 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0
 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1000
y_hat: 
[0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 1 1 0 1 0 0 1 0 1 0 1 0 1 0 0 1 0 0 1 0 0 0
 1 1 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 1 1 0 1 1 0 1 0 1 0 0 0 0 0 1 1 0 0 1
 1 0 0 1 0 1 0 1 1 0 1 0 1 1 1 1 0 1 1 0 0 1 0 1 1 0 1 1 0 1 1 0 0 0 1 0 0
 0 1 0 1 0 1 0 1 1 1 0 0 1 1 0 1 0 1 1 1 1 0 1 0 1 0 0 1 0]
y_lab: 
[0 1 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 0
 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1
 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0
 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0]
        0  avr.
ICC  0.73  0.73
PCC  0.73  0.73
RMSE 0.37  0.37
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.87  0.87

------------------------------------------------------------------------------------
y_hat: 
[0 1 1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 0 1 0 0 1 0 1 1
 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 1 1 0
 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 0 1 0
 1 0 1 0 1 0 1 0 1 0 1 1 0 0 0 0 1 1 0 0 1 1 0 0 0 0 1 0 1]
y_lab: 
[0 1 1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1
 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0
 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 0 1 0
 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1100
y_hat: 
[1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 1 1 0 0 1 0 1 1 0 1 0 1 0 0 0 1 0 1 0 0 0 1
 0 1 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 1 1 0 1 1 1 0 1 0 0 0 0 0 1 0 0 1 1 0
 1 0 0 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 0 1 1 0 0 1 1 0 1 1 1 0 0 1 0 0 1 0 0
 0 1 0 0 1 0 1 1 1 0 1 0 1 0 1 0 1 1 1 1 1 0 1 0 1 0 0 0 1]
y_lab: 
[1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0
 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 0 1 0 1 1 0 1
 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1]
        0  avr.
ICC  0.73  0.73
PCC  0.73  0.73
RMSE 0.37  0.37
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.87  0.87

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 0 1 0 1 0 0 1 0
 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 0 0 1 0 0 0 0 0 0 0 1 1 0
 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1
 0 0 1 1 0 0 1 0 1 1 0 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 1 0]
y_lab: 
[1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0
 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0
 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1
 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1200
y_hat: 
[1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 1 0 1 0 1 1 0 1 0 1 0 1 0 0 0 1 0 0 1 0 0 1
 0 1 1 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 0 0 0 0 1 0 1 1 0
 1 0 1 0 1 0 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 0 0 1 1 0 1 1 0 1 1 0 0 0 0 1 0
 0 1 0 0 1 1 0 1 1 0 1 1 0 0 1 0 1 1 1 1 1 0 1 0 1 0 0 0 1]
y_lab: 
[1 0 1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1
 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0
 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1
 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1]
        0  avr.
ICC  0.73  0.73
PCC  0.73  0.73
RMSE 0.37  0.37
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.87  0.87

------------------------------------------------------------------------------------
y_hat: 
[1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 0 1 0 1 0 1 0 0
 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 0 1 0 0 0 0 0 0 0 1 0 1 0
 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0
 1 0 1 1 0 1 0 1 0 1 0 0 1 0 0 0 1 0 1 1 0 1 0 0 0 0 1 0 1]
y_lab: 
[1 0 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 1 0 0
 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0
 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0
 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 0 1 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1300
y_hat: 
[0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 1 1 0 0 1 1 0 1 0 1 0 1 0 0 0 0 1 1 0 0 0 0
 1 1 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 1 0 1 1 1 1 0 0 1 0 0 0 0 0 1 0 1 0 1
 1 0 0 1 0 1 0 1 0 1 0 1 1 1 1 1 1 0 0 1 1 0 0 1 1 0 1 1 0 1 1 0 0 0 0 1 0
 0 0 1 0 1 0 1 1 1 1 0 0 1 0 1 0 1 1 1 1 1 1 0 1 0 0 0 0 1]
y_lab: 
[0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0
 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1
 1 0 0 1 0 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1
 0 0 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1]
        0  avr.
ICC  0.73  0.73
PCC  0.73  0.73
RMSE 0.37  0.37
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.87  0.87

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 0 0 1 1 0 1 0 0
 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1
 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1
 0 0 1 1 0 0 1 1 0 0 1 1 0 0 0 1 0 0 1 1 0 0 1 0 0 0 1 0 1]
y_lab: 
[1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0
 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1
 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1
 0 0 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1400
y_hat: 
[1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 1 1 0 1 0 0 1 0 1 1 0 0 1 0 0 1 0 0 1 0 0 0
 1 1 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1 1 0 1 1 1 0 1 1 0 0 0 0 0 1 0 1 0 0 1
 0 1 1 0 1 0 1 0 0 1 1 0 1 1 1 1 1 0 1 0 0 0 0 1 1 0 1 1 1 0 0 1 0 0 0 1 0
 0 0 1 0 1 1 0 1 1 0 1 1 0 0 1 1 0 1 1 1 1 0 1 0 1 0 0 0 1]
y_lab: 
[1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0
 1 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 0 1
 0 1 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1
 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1]
        0  avr.
ICC  0.71  0.71
PCC  0.71  0.71
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.86  0.86

------------------------------------------------------------------------------------
y_hat: 
[0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 1 0 1 0 0 1 0 1 0 0 1 0 1 0 1 0 0
 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 1 0 1
 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1
 0 0 1 0 1 1 0 1 0 1 0 0 1 0 0 0 1 0 1 0 1 0 1 0 0 0 1 1 0]
y_lab: 
[0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0
 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 0 1
 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1
 0 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1500
y_hat: 
[0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 1 1 0 1 0 0 1 0 1 0 1 0 1 0 0 0 1 0 1 0 0 0
 1 1 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 1 1 1 0 1 1 0 1 1 0 0 0 0 0 1 0 0 1 0 1
 0 1 0 1 1 0 1 0 0 1 1 0 1 1 1 1 0 1 1 0 0 0 0 1 1 0 1 1 0 1 1 0 0 0 0 1 0
 0 0 1 1 0 0 1 1 1 0 1 1 0 0 1 0 1 1 1 1 1 1 0 0 1 0 0 0 1]
y_lab: 
[0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0
 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1
 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1
 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 0 1]
        0  avr.
ICC  0.71  0.71
PCC  0.71  0.71
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.86  0.86

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 0 1 0 0 1 1 0 1
 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0 1 0
 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 0
 1 1 0 0 1 1 0 1 0 1 0 0 1 0 0 1 0 0 1 0 1 1 0 0 0 1 0 0 1]
y_lab: 
[1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1
 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0
 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 0
 1 1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1600
y_hat: 
[1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 1 0 1 0 1 1 0 1 0 0 1 0 1 0 0 0 1 0 1 0 0 0
 1 1 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 1 1 0 1 1 0 1 1 0 0 0 0 0 1 0 0 1 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 1 1 1 1 1 0 0 1 0 0 0 1 0 1 1 1 0 1 0 1 0 0 0 1 0
 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 1 1 1 1 0 1 1 0 0 0 1 0]
y_lab: 
[1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 0 1 1 0 0
 1 0 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 1 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0]
        0  avr.
ICC  0.71  0.71
PCC  0.71  0.71
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.86  0.86

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 0 0 1 1 0 0 1 0
 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 1 1 0
 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0
 1 0 1 0 1 0 1 0 1 1 0 0 1 0 0 1 0 0 1 0 1 0 1 0 0 1 0 0 1]
y_lab: 
[1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0
 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 1 0
 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0
 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1700
y_hat: 
[0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 0 1 0 1 0 0 1
 0 1 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 1 1 0 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 1
 1 0 0 1 1 0 1 0 0 1 1 0 1 1 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0 1 1 0 0 0 1 0 0
 0 0 1 1 0 1 0 1 1 0 1 1 0 1 0 0 1 1 1 1 1 0 1 0 1 0 0 0 1]
y_lab: 
[0 1 0 1 0 1 0 1 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 0 1
 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1
 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0
 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 1]
        0  avr.
ICC  0.71  0.71
PCC  0.71  0.71
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.86  0.86

------------------------------------------------------------------------------------
y_hat: 
[0 1 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 0 1 0 0 1 1 0 0
 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 1 0 1
 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1
 0 0 1 1 0 1 0 1 0 1 0 0 1 0 0 0 1 1 0 1 0 1 0 0 0 1 0 0 1]
y_lab: 
[0 1 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0
 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 0 1
 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 0 1 1
 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1800
y_hat: 
[1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 1 1 0 0 1 1 0 0 1 0 1 1 0 0 0 0 1 1 0 0 0 0
 1 1 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 0 0 0 0 1 0 1 0 1
 1 0 0 1 0 1 0 1 1 0 0 1 1 1 1 1 1 0 1 0 0 0 0 1 0 1 1 1 1 0 0 1 0 0 1 0 0
 0 0 1 1 0 0 1 1 1 1 0 1 0 0 1 0 1 1 1 1 1 1 0 1 0 0 0 1 0]
y_lab: 
[1 0 1 0 0 1 0 1 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0
 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1
 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 0
 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0]
        0  avr.
ICC  0.71  0.71
PCC  0.71  0.71
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.86  0.86

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 1 0 0 0 1 0 1 0 0 1 1
 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 1 1 0
 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1
 0 0 1 0 1 0 1 1 0 1 0 1 0 0 0 1 0 0 1 1 0 1 0 0 0 1 0 1 0]
y_lab: 
[1 0 0 1 1 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1
 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 0 1 1 0 1 0 1 0 0 1 0 1 1 0
 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1
 0 0 1 0 1 0 1 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 1 0]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
Iteration 1900
y_hat: 
[0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 1 1 0 0 1 1 0 0 1 0 1 0 1 0 0 0 1 0 1 0 0 0
 1 1 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 1 1 0 1 1 1 0 1 0 0 0 0 0 1 0 0 1 0 1
 1 0 0 1 1 0 1 0 1 0 1 0 1 1 1 1 0 1 0 1 0 0 1 0 1 0 1 1 1 0 1 0 0 0 1 0 0
 0 1 0 0 1 0 1 1 1 1 0 0 1 0 1 1 0 1 1 1 1 0 1 0 1 0 0 0 1]
y_lab: 
[0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 0 1 0 1 0 1 1 0 0
 1 0 1 0 1 1 0 0 1 0 1 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 0 1
 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1
 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0 1]
        0  avr.
ICC  0.71  0.71
PCC  0.71  0.71
RMSE 0.38  0.38
MAE  0.14  0.14
ACC  0.86  0.86
F1-b 0.86  0.86

------------------------------------------------------------------------------------
y_hat: 
[1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 0 0 0 1 0 1 0 1 0
 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 1 0 1 0
 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1
 0 1 0 0 1 1 0 1 0 1 0 1 0 0 0 0 1 0 1 1 0 0 1 0 0 0 1 0 1]
y_lab: 
[1 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 0 1 0
 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 1 0
 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1
 0 1 0 0 1 1 0 1 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 0 1 0 1 0 1]
        0  avr.
ICC  0.90  0.90
PCC  0.90  0.90
RMSE 0.22  0.22
MAE  0.05  0.05
ACC  0.95  0.95
F1-b 0.95  0.95

====================================================================================
=======================================================
>>>>>> elapse time: 0:03:41.052546
=======================================================
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Traceback (most recent call last):
  File "main.py", line 27, in <module>
    import tensorflow as tf
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/__init__.py", line 24, in <module>
    from tensorflow.python import *
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/__init__.py", line 82, in <module>
    from tensorflow.python import keras
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/__init__.py", line 26, in <module>
    from tensorflow.python.keras import activations
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/activations/__init__.py", line 22, in <module>
    from tensorflow.python.keras._impl.keras.activations import elu
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/_impl/keras/__init__.py", line 21, in <module>
    from tensorflow.python.keras._impl.keras import activations
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/_impl/keras/activations.py", line 24, in <module>
    from tensorflow.python.keras._impl.keras.engine import Layer
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/_impl/keras/engine/__init__.py", line 21, in <module>
    from tensorflow.python.keras._impl.keras.engine.topology import get_source_inputs
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/_impl/keras/engine/topology.py", line 31, in <module>
    from tensorflow.python.keras._impl.keras.utils import conv_utils
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/_impl/keras/utils/__init__.py", line 24, in <module>
    from tensorflow.python.keras._impl.keras.utils import io_utils
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/_impl/keras/utils/io_utils.py", line 27, in <module>
    import h5py  # pylint:disable=g-import-not-at-top
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py", line 49, in <module>
    from ._hl.files import File
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 26, in <module>
    from .. import version
  File "<frozen importlib._bootstrap>", line 971, in _find_and_load
  File "<frozen importlib._bootstrap>", line 955, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 665, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 674, in exec_module
  File "<frozen importlib._bootstrap_external>", line 764, in get_code
  File "<frozen importlib._bootstrap_external>", line 832, in get_data
KeyboardInterrupt
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame749.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1616.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1416.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1312.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1984.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2381.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1104.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2752.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame746.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2399.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame259.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame12.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame79.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame288.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame159.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame18.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame111.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame107.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame326.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame58.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1418.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1284.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame808.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1875.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2765.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1607.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1285.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame52.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1416.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1520.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1036.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame344.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame314.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame884.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1789.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1071.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame267.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame302.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1190.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2712.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1608.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1118.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1029.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1862.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1210.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1250.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1086.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2361.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame141.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame229.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame527.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame265.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame496.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame547.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame543.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame155.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame472.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2431.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1316.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2522.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame871.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame840.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame175.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2183.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame863.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2149.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame475.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame452.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame60.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1735.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1745.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame237.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame583.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame345.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame528.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1615.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2008.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1012.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1234.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1326.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2087.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1979.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1919.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2427.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame974.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame525.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame644.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame261.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame515.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame510.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame563.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame198.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame562.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame637.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3226.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1907.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame987.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1909.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1002.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2600.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3229.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2804.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1964.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3049.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame609.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame356.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame900.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame861.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame803.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame518.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame911.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame492.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1076.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame394.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame593.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2671.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame391.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2172.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame380.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2684.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1894.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1759.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2384.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame782.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame790.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame526.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame13.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame818.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame530.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame237.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame457.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame74.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame494.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1127.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1606.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame48.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1449.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame543.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2470.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1596.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame50.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1095.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1838.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame510.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame521.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame198.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame302.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame439.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame318.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame469.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame299.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2767.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2571.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame487.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame480.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2398.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame718.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1471.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2865.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1156.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame387.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame405.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame1298.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame841.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame980.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame941.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame888.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame669.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame404.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame955.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame699.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2135.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1704.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2936.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1558.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1234.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2566.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame270.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1813.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1408.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame134.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame231.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame61.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame588.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame918.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame674.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame12.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame913.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame936.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1288.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1866.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2417.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1587.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2159.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2287.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame453.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2761.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2087.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame605.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame533.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame207.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame500.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame196.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame362.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame530.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame174.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame398.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame311.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame905.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2727.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1461.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1766.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1273.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2285.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame899.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame700.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1608.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2597.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame394.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame752.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame169.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame181.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame574.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame696.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame568.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame247.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame656.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame195.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2644.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2495.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2265.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1994.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame506.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2367.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2608.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame626.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2455.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1149.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1175.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame241.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame841.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1162.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame245.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame786.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame369.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1181.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame742.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1896.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1930.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1996.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2365.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2646.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2380.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1409.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2276.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2465.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame532.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame591.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame268.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame321.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame307.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame97.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame42.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame318.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame95.jpg'],
      dtype='<U70')]
inputa_files:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame749.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1616.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1416.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1312.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1984.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame259.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame12.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame79.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame288.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame159.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1418.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1284.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame808.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1875.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2765.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1036.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame344.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame314.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame884.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1789.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1190.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2712.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1118.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1029.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame141.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame229.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame527.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame265.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame496.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2431.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1316.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2522.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame871.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame475.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame452.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame60.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1735.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1745.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1615.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2008.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1012.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1234.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1326.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame525.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame644.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame261.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame515.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3226.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1907.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame987.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1909.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1002.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame609.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame356.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame900.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame861.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame803.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame593.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2671.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame391.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2172.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame380.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame782.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame790.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame526.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame13.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame818.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1127.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1606.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame48.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1449.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame543.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame510.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame521.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame198.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2767.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2571.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame487.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame480.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame387.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame405.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame1298.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame841.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame980.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame699.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2135.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1704.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2936.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1558.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame134.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame231.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame61.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame588.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame918.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1288.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1866.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2417.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1587.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2159.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame605.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame533.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame207.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame500.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame196.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame905.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2727.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1461.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1766.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1273.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame394.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame752.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame169.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame181.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame574.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2644.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2495.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2265.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1994.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1642.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1149.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1175.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame241.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame841.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1162.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1896.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1930.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1996.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2365.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame642.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame532.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame591.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame268.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame321.jpg']
inputb_files:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2381.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1104.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2752.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame746.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2399.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame18.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame111.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame107.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame326.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame58.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1607.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1285.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame52.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1416.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1520.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1071.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame267.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1223.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame302.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1862.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1210.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1250.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1086.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2361.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame547.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame543.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame155.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame472.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame840.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame175.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2183.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame863.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2149.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame237.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame583.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame345.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame528.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2087.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1979.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1919.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2427.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame974.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame510.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame563.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame198.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame562.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame637.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2600.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3229.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2804.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1964.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3049.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame518.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame911.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame492.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1076.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame394.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2684.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1894.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1759.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2384.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame530.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame237.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame457.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame74.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame494.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2470.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1596.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame50.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1095.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1838.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame302.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame439.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame318.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame469.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame299.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2398.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame718.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1471.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2865.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1156.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame941.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame888.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame669.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame404.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame955.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1234.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2566.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame270.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1813.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1408.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame674.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame12.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame913.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame936.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2287.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2199.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame453.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2761.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2087.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame362.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame530.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame174.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame398.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame311.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2285.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame899.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame700.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2597.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame696.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame568.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame247.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame656.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame195.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame506.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2367.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame626.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2455.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame245.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame786.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame369.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1181.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame742.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2646.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2380.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1409.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2276.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2465.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame307.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame97.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame42.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame318.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame95.jpg']
labela:  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]
labelb:  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]
=========================================================================
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/transform/_warps.py:84: UserWarning: The default mode, 'constant', will be changed to 'reflect' in skimage 0.15.
  warn("The default mode, 'constant', will be changed to 'reflect' in "
2018-06-26 16:32:21.929088: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-26 16:32:33.925433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-26 16:32:34.108820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-26 16:32:34.313488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-26 16:32:34.530169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-26 16:32:34.530737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-26 16:32:34.530793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-26 16:32:34.530799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-26 16:32:34.530802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-26 16:32:34.530805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-26 16:32:34.530808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-26 16:32:34.530819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-06-26 16:32:34.530824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-06-26 16:32:34.530828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-06-26 16:32:34.530831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
Traceback (most recent call last):
  File "main.py", line 367, in <module>
    main()
  File "main.py", line 210, in main
    inputa, inputb, labela, labelb= data_generator.make_data_tensor()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 126, in make_data_tensor
    inputb_latent_feat, self.pred_weights = latent_feature(inputb_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 121, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 68, in computeLatentVal
    self.model_train.load_weights("./model78.h5")
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 2708, in load_weights
    self.load_weights_from_hdf5_group(f)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 2794, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1868, in batch_set_value
    value = np.asarray(value)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/core/numeric.py", line 492, in asarray
    return array(a, dtype, copy=False, order=order)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/dataset.py", line 696, in __array__
    self.read_direct(arr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/dataset.py", line 657, in read_direct
    self.id.read(mspace, fspace, dest, dxpl=self._dxpl)
KeyboardInterrupt
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame749.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1616.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1416.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1312.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1984.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2381.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1104.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2752.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame746.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2399.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame259.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame12.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame79.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame288.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame159.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame18.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame111.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame107.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame326.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame58.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1418.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1284.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame808.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1875.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2765.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1607.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1285.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame52.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1416.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1520.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1036.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame344.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame314.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame884.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1789.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1071.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame267.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame302.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1190.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2712.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1608.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1118.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1029.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1862.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1210.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1250.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1086.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2361.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame141.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame229.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame527.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame265.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame496.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame547.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame543.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame155.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame472.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2431.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1316.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2522.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame871.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame840.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame175.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2183.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame863.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2149.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame475.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame452.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame60.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1735.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1745.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame237.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame583.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame345.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame528.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1615.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2008.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1012.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1234.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1326.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2087.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1979.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1919.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2427.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame974.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame525.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame644.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame261.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame515.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame510.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame563.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame198.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame562.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame637.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3226.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1907.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame987.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1909.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1002.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2600.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3229.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2804.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1964.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3049.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame609.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame356.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame900.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame861.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame803.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame518.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame911.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame492.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1076.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame394.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame593.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2671.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame391.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2172.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame380.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2684.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1894.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1759.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2384.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame782.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame790.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame526.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame13.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame818.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame530.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame237.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame457.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame74.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame494.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1127.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1606.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame48.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1449.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame543.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2470.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1596.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame50.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1095.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1838.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame510.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame521.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame198.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame302.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame439.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame318.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame469.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame299.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2767.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2571.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame487.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame480.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2398.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame718.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1471.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2865.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1156.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame387.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame405.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame1298.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame841.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame980.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame941.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame888.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame669.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame404.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame955.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame699.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2135.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1704.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2936.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1558.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1234.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2566.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame270.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1813.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1408.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame134.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame231.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame61.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame588.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame918.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame674.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame12.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame913.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame936.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1288.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1866.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2417.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1587.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2159.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2287.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame453.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2761.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2087.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame605.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame533.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame207.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame500.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame196.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame362.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame530.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame174.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame398.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame311.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame905.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2727.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1461.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1766.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1273.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2285.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame899.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame700.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1608.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2597.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame394.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame752.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame169.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame181.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame574.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame696.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame568.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame247.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame656.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame195.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2644.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2495.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2265.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1994.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame506.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2367.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2608.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame626.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2455.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1149.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1175.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame241.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame841.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1162.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame245.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame786.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame369.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1181.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame742.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1896.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1930.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1996.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2365.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2646.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2380.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1409.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2276.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2465.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame532.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame591.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame268.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame321.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame307.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame97.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame42.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame318.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame95.jpg'],
      dtype='<U70')]
inputa_files:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame749.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1616.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1416.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1312.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1984.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame259.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame12.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame79.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame288.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame159.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1418.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1284.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame808.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1875.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2765.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1036.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame344.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame314.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame884.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1789.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1190.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2712.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1118.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1029.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame141.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame229.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame527.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame265.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame496.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2431.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1316.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2522.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame871.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame475.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame452.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame60.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1735.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1745.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1615.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2008.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1012.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1234.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1326.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame525.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame644.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame261.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame515.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3226.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1907.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame987.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1909.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1002.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame609.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame356.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame900.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame861.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame803.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame593.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2671.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame391.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2172.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame380.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame782.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame790.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame526.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame13.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame818.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1127.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1606.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame48.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1449.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame543.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame510.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame521.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame198.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2767.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2571.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame147.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame487.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame480.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame387.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame405.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame1298.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame841.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame980.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame699.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2135.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1704.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2936.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1558.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame134.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame231.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame61.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame588.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame918.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1288.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1866.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2417.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1587.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2159.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame605.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame533.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame207.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame500.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame196.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame905.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2727.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1461.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1766.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1273.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame394.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame752.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame169.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame181.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame574.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2644.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2495.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2265.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1994.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1642.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1149.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1175.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame241.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame841.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1162.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1896.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1930.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1996.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2365.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame642.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame532.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame591.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame268.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame321.jpg']
inputb_files:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2381.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1104.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2752.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame746.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2399.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame18.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame111.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame107.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame326.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame58.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1607.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1285.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame52.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1416.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1520.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1071.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame267.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1223.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame302.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1862.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1210.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1250.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1086.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2361.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame547.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame543.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame155.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame472.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame840.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame175.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2183.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame863.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2149.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame237.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame583.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame345.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame528.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2087.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1979.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1919.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2427.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame974.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame510.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame563.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame198.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame562.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame637.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2600.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3229.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2804.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1964.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3049.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame518.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame911.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame492.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1076.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame394.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2684.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2319.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1894.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1759.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2384.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame530.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame237.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame457.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame74.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame494.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2470.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1596.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame50.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1095.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1838.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame302.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame439.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame318.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame469.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame299.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2398.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame718.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1471.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2865.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1156.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame941.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame888.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame669.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame404.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame955.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1234.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2566.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame270.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1813.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1408.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame674.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame177.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame12.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame913.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame936.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2287.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2199.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame453.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2761.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2087.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame362.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame530.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame174.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame398.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame311.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2285.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame899.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame700.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2597.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame696.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame568.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame247.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame656.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame195.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame506.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2367.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2608.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame626.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2455.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame245.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame786.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame369.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1181.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame742.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2646.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2380.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1409.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2276.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2465.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame307.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame97.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame42.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame318.jpg', '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame95.jpg']
labela:  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]
labelb:  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]
=========================================================================
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
Traceback (most recent call last):
  File "main.py", line 367, in <module>
    main()
  File "main.py", line 210, in main
    inputa, inputb, labela, labelb= data_generator.make_data_tensor()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 92, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 43, in __init__
    z = Lambda(sampling, output_shape=(latent_dim,))([z_mean, z_log_sigma]) #  feature space    z
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 172, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors, mask=input_masks))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/core.py", line 641, in call
    return self.function(x, **arguments)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 39, in sampling
    epsilon.append(KB.random_normal(shape=[batch_size, 1], mean=m, std=s))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2935, in random_normal
    dtype=dtype, seed=seed)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/random_ops.py", line 76, in random_normal
    shape_tensor, dtype, seed=seed1, seed2=seed2)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_random_ops.py", line 420, in _random_standard_normal
    seed2=seed2, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 686, in _call_cpp_shape_fn_impl
    input_tensors_as_shapes, status)
KeyboardInterrupt
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame497.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2044.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1415.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame640.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame700.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2752.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2174.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1191.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame955.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame610.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame90.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame157.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame279.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame238.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame77.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame178.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame103.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame107.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame181.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame193.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2164.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame18.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame676.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2695.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1031.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2724.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2141.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1540.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame473.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2781.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame798.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame795.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1164.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame797.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1206.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1133.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1087.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame876.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1218.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame771.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2242.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2779.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2780.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame443.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2519.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1104.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame439.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2260.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1631.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame136.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame200.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame288.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame211.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame192.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame232.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame124.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame210.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame348.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame147.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1059.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1322.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2325.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2069.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame912.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1468.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2246.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1598.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2315.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1010.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame772.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1702.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame63.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame74.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame333.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame355.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame10.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame287.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame822.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame4.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2099.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame385.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1824.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1878.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame17.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1972.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2362.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2187.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2209.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1018.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame545.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame304.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame160.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame560.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame300.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame613.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame219.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame216.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1952.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2990.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3302.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2307.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame75.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1667.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2005.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2437.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame1976.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2069.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1048.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame286.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame356.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame169.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1039.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame150.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame620.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame386.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame519.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame1193.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1275.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1759.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2284.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1830.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1444.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame606.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2226.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2317.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2559.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2279.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame474.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame715.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame812.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame41.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame206.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame3.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame262.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame518.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame736.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame476.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2553.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2281.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1207.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame117.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1028.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1838.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2118.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2097.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1277.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame953.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame505.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame250.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame142.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame469.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame194.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame417.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame129.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame218.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame121.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame309.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2340.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame299.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame687.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame480.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame548.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame459.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1649.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2156.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1226.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2515.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame763.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame855.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame404.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame26.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame769.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame802.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame399.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame370.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame443.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1408.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1918.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2888.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2995.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2776.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1816.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2060.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1607.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1696.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame447.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame649.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame193.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame759.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame961.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame27.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame930.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame631.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame78.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame800.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame164.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1671.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2639.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame111.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2360.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2507.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame945.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame47.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2340.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1454.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame186.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame526.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame182.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame274.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame529.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame260.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame202.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame609.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame577.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame578.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1617.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1734.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2786.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1875.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1928.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2545.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame25.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2559.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2832.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame112.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame264.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame391.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame493.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame272.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame268.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame379.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame335.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame782.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame409.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame346.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame115.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2357.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2449.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2781.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame615.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame118.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame452.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2764.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2073.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1592.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1133.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame792.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame916.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1112.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame743.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1173.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame168.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame132.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1396.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame294.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1594.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1086.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2276.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame446.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1776.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2365.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame379.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2226.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame537.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame324.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame160.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame177.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame136.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame64.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame78.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame165.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame55.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame536.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/transform/_warps.py:84: UserWarning: The default mode, 'constant', will be changed to 'reflect' in skimage 0.15.
  warn("The default mode, 'constant', will be changed to 'reflect' in "
Traceback (most recent call last):
  File "main.py", line 363, in <module>
    main()
  File "main.py", line 270, in main
    inputa, inputb, labela, labelb= data_generator.make_data_tensor()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 116, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 112, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 69, in computeLatentVal
    self.model_train.load_weights("./model78.h5")
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 2708, in load_weights
    self.load_weights_from_hdf5_group(f)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 2794, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1868, in batch_set_value
    value = np.asarray(value)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/core/numeric.py", line 492, in asarray
    return array(a, dtype, copy=False, order=order)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/dataset.py", line 696, in __array__
    self.read_direct(arr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/dataset.py", line 657, in read_direct
    self.id.read(mspace, fspace, dest, dxpl=self._dxpl)
KeyboardInterrupt
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    import numpy as np
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/__init__.py", line 142, in <module>
    from . import add_newdocs
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/add_newdocs.py", line 13, in <module>
    from numpy.lib import add_newdoc
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/lib/__init__.py", line 8, in <module>
    from .type_check import *
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/lib/type_check.py", line 11, in <module>
    import numpy.core.numeric as _nx
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/core/__init__.py", line 74, in <module>
    from numpy.testing import _numpy_tester
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/testing/__init__.py", line 12, in <module>
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1116.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1164.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2282.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1622.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1117.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame1950.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2392.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2399.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2438.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/off/frame2103.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame327.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame276.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame288.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame84.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame116.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame302.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame147.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame51.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame174.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN001/on/frame74.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1240.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1440.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1010.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1849.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame949.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1654.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame52.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame2128.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame1428.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/off/frame472.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1093.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame182.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame156.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame887.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame188.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1034.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame735.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1784.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame179.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN002/on/frame1057.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1069.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2170.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame2302.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1731.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame377.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1688.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame901.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame17.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1987.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/off/frame1603.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame479.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame203.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame93.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame214.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame259.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame140.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame91.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame529.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame503.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN003/on/frame353.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1667.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1279.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1222.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame198.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame2523.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1588.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame121.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1124.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame1502.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/off/frame181.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame489.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame4.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame831.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame300.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame726.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame780.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1674.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame1782.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame457.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN004/on/frame757.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2065.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1027.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame409.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1979.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1972.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1432.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2519.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame2066.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame1004.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/off/frame422.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame629.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame167.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame630.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame544.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame296.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame306.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame236.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame646.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame270.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN005/on/frame194.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3222.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2606.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2626.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2877.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame19.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame2630.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame3096.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame971.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame937.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/off/frame966.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame786.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame729.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame649.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame128.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame235.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame728.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame567.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame378.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame374.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN006/on/frame588.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame665.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2946.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1886.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1617.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2036.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame391.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1927.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame1454.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame922.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/off/frame2864.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame790.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame262.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame286.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame196.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame473.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame487.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame272.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame774.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame748.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN007/on/frame573.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame825.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1585.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2470.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1564.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2078.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame107.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1247.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame2096.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame866.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/off/frame1246.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame309.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame172.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame195.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame477.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame230.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame423.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame140.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame166.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame231.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN008/on/frame522.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2584.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1244.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2641.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1176.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame565.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame636.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1708.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2398.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame1223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/off/frame2682.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame832.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame790.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame403.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame850.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame655.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame769.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame1299.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame782.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame412.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN009/on/frame785.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2613.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame706.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1240.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1264.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2566.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2995.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame1517.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame364.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame374.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/off/frame2107.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame211.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame158.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame247.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame257.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame641.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame13.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame93.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame889.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN010/on/frame612.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1518.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2073.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1505.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2138.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1978.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1426.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame2340.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1296.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1397.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/off/frame1463.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame197.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame274.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame574.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame210.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame196.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame376.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame331.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame335.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame208.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN011/on/frame157.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2545.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2363.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2399.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2686.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1638.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2021.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame1978.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame594.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2585.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/off/frame2586.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame554.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame308.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame299.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame572.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame235.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame740.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame338.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame417.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame472.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN012/on/frame785.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame623.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame507.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame711.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2171.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1635.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame410.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame1624.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2102.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame2153.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/off/frame614.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame156.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1358.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame241.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame327.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame153.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1253.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame815.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame845.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame752.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN013/on/frame1312.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1932.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame444.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1214.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1050.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2080.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2344.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame1090.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2601.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2554.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/off/frame2569.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame106.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame153.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame347.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame295.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame539.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame319.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame537.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame321.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame520.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN016/on/frame357.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
Traceback (most recent call last):
  File "main.py", line 393, in <module>
    main()
  File "main.py", line 296, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 83, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 43, in __init__
    z = Lambda(sampling, output_shape=(latent_dim,))([z_mean, z_log_sigma]) #  feature space    z
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 172, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors, mask=input_masks))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/core.py", line 641, in call
    return self.function(x, **arguments)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 39, in sampling
    epsilon.append(KB.random_normal(shape=[batch_size, 1], mean=m, std=s))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2935, in random_normal
    dtype=dtype, seed=seed)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/random_ops.py", line 76, in random_normal
    shape_tensor, dtype, seed=seed1, seed2=seed2)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_random_ops.py", line 420, in _random_standard_normal
    seed2=seed2, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 676, in _call_cpp_shape_fn_impl
    s = tensor_util.constant_value_as_shape(op.inputs[idx])
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_util.py", line 845, in constant_value_as_shape
    [d if d >= 0 else None for d in value]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py", line 580, in merge_with
    return TensorShape(new_dims)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py", line 455, in __init__
    self._dims = [as_dimension(d) for d in dims_iter]
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py", line 455, in <listcomp>
    self._dims = [as_dimension(d) for d in dims_iter]
KeyboardInterrupt
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame855.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2154.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1993.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2405.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2074.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1002.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1615.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2270.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame108.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2521.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame323.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame295.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame164.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame279.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame686.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame684.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame274.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame644.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame625.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame294.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:30:22.875901: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:30:23.179337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:30:23.394137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:30:23.597905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:30:23.799518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:30:23.799870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:30:23.799947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:30:23.799955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:30:23.799959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:30:23.799963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:30:23.799968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:30:23.799978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:30:23.799984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:30:23.799990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:30:23.799995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:30:35.339270: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:30:35.340224: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:30:35.340263: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340279: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:30:35.340301: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340316: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:30:35.340332: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:30:35.340345: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340360: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:30:35.340373: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340388: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:30:35.340403: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:30:35.340415: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340429: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:30:35.340441: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340453: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340466: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340482: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:30:35.340494: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340507: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340519: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340531: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:35.340546: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:30:35.340567: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:30:35.340580: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:30:35.340589: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:30:35.340598: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:30:35.340606: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:30:35.340614: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:30:35.340622: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:30:35.340631: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:30:35.340639: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:30:35.340647: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:30:35.340655: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:30:35.340663: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:30:35.340671: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:30:35.340679: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:30:35.340688: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:30:35.340696: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:30:35.340704: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:30:35.340712: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:30:35.340720: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:30:35.340728: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:30:35.340737: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:30:35.340745: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:30:35.340753: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:30:35.340761: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:30:35.340769: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:30:35.340777: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:30:35.340786: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:30:35.340794: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:30:35.340802: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:30:35.340811: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:30:35.340819: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:30:35.340828: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:30:35.340836: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:30:35.340847: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:30:35.340855: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:30:35.340864: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:30:35.340872: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:30:35.340882: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:30:35.340890: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:30:35.340898: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:30:35.340907: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:30:35.340915: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:30:35.340923: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:30:35.340931: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:30:35.340939: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:30:35.340947: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:30:35.340956: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:30:35.340964: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:30:35.340972: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:30:35.340980: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:30:35.340988: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:30:35.340996: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:30:35.341004: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:30:35.341013: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:30:35.341021: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:30:35.341029: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:30:35.341037: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:30:35.341045: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:30:35.341054: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:30:35.341062: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:30:35.341070: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:30:35.341078: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:30:35.341086: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:30:35.341094: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:30:35.341102: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:30:35.341111: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:30:35.341120: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:30:35.341128: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:30:35.341139: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:30:35.341148: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:30:35.341156: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:30:35.341165: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:30:35.341173: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:30:35.341181: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:30:35.341190: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:30:35.341199: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:30:35.341207: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:30:35.341216: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:30:35.341224: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:30:35.341233: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:30:35.341241: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:30:35.341250: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:30:35.341258: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:30:35.341266: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:30:35.341275: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:30:35.341283: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:30:35.341291: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:30:35.341299: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:30:35.341308: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:30:35.341316: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:30:35.341324: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:30:35.341332: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:30:35.341340: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:30:35.341348: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:30:35.341357: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:30:35.341365: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:30:35.341373: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:30:35.341381: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:30:35.341389: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:30:35.341397: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:30:35.341406: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:30:35.341414: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:30:35.341423: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:30:35.341434: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:30:35.341443: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:30:35.341453: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:30:35.341461: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:30:35.341470: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:30:35.341478: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:30:35.341486: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:30:35.341495: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:30:35.341503: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:30:35.341512: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:30:35.341520: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:30:35.341528: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:30:35.341540: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:30:35.341551: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:30:35.341562: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:30:35.341572: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:30:35.341583: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:30:35.341593: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:30:35.341604: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:30:35.341615: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:30:35.341625: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:30:35.341636: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:30:35.341646: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:30:35.341657: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:30:35.341668: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:30:35.341678: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:30:35.341692: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152375552
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:30:35.341717: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:30:35.341741: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1634.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2133.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame566.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2509.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1994.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2813.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1858.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1908.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1025.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame675.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame582.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame655.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame2.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame679.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame659.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame614.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame635.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame642.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame274.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:30:47.347893: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:30:47.656643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:30:47.844982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:30:48.040090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:30:48.225597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:30:48.225942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:30:48.226015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:30:48.226023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:30:48.226027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:30:48.226031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:30:48.226035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:30:48.226046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:30:48.226051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:30:48.226056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:30:48.226060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:30:59.757743: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:30:59.758212: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:30:59.758245: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758262: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:30:59.758274: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758288: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:30:59.758303: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:30:59.758326: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758341: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:30:59.758353: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758366: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:30:59.758379: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:30:59.758390: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758403: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:30:59.758414: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758425: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758437: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758452: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:30:59.758463: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758475: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758486: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758497: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:30:59.758509: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:30:59.758528: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:30:59.758540: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:30:59.758549: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:30:59.758556: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:30:59.758564: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:30:59.758576: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:30:59.758583: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:30:59.758591: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:30:59.758598: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:30:59.758606: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:30:59.758613: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:30:59.758621: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:30:59.758628: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:30:59.758636: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:30:59.758643: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:30:59.758650: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:30:59.758697: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:30:59.758706: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:30:59.758714: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:30:59.758721: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:30:59.758730: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:30:59.758737: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:30:59.758745: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:30:59.758752: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:30:59.758759: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:30:59.758767: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:30:59.758775: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:30:59.758782: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:30:59.758790: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:30:59.758797: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:30:59.758805: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:30:59.758813: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:30:59.758820: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:30:59.758827: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:30:59.758835: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:30:59.758842: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:30:59.758850: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:30:59.758858: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:30:59.758866: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:30:59.758874: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:30:59.758887: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:30:59.758895: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:30:59.758903: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:30:59.758910: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:30:59.758917: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:30:59.758925: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:30:59.758933: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:30:59.758940: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:30:59.758947: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:30:59.758955: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:30:59.758962: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:30:59.758970: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:30:59.758977: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:30:59.758984: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:30:59.758992: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:30:59.758999: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:30:59.759007: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:30:59.759014: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:30:59.759021: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:30:59.759029: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:30:59.759036: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:30:59.759044: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:30:59.759051: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:30:59.759059: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:30:59.759066: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:30:59.759073: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:30:59.759082: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:30:59.759090: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:30:59.759097: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:30:59.759105: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:30:59.759112: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:30:59.759120: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:30:59.759127: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:30:59.759135: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:30:59.759143: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:30:59.759157: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:30:59.759165: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:30:59.759173: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:30:59.759181: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:30:59.759189: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:30:59.759197: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:30:59.759204: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:30:59.759212: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:30:59.759220: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:30:59.759227: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:30:59.759235: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:30:59.759242: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:30:59.759250: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:30:59.759257: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:30:59.759264: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:30:59.759272: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:30:59.759279: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:30:59.759287: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:30:59.759294: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:30:59.759302: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:30:59.759309: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:30:59.759317: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:30:59.759324: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:30:59.759331: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:30:59.759339: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:30:59.759346: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:30:59.759354: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:30:59.759362: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:30:59.759369: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:30:59.759378: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:30:59.759386: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:30:59.759394: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:30:59.759402: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:30:59.759409: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:30:59.759421: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:30:59.759429: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:30:59.759437: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:30:59.759444: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:30:59.759452: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:30:59.759459: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:30:59.759473: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:30:59.759484: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:30:59.759493: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:30:59.759503: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:30:59.759512: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:30:59.759522: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:30:59.759531: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:30:59.759541: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:30:59.759551: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:30:59.759560: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:30:59.759569: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:30:59.759579: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:30:59.759589: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:30:59.759598: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:30:59.759612: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152354560
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:30:59.759636: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:30:59.759658: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1052.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1032.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2422.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1858.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1974.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame547.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1413.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2270.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2200.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1999.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame280.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame695.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame588.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame330.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame342.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame159.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame275.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame729.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame736.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame711.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:31:11.568741: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:31:11.873374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:31:12.074351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:31:12.284975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:31:12.475365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:31:12.475708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:31:12.475784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:31:12.475792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:31:12.475797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:31:12.475801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:31:12.475805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:31:12.475816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:31:12.475822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:31:12.475827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:31:12.475831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:31:24.055229: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:31:24.055881: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:31:24.055925: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.055940: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:31:24.055953: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.055968: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:31:24.055982: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:31:24.055995: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056010: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:31:24.056021: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056051: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:31:24.056065: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:31:24.056076: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056089: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:31:24.056100: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056111: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056123: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056138: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:31:24.056150: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056162: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056173: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056184: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:24.056196: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:31:24.056215: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:31:24.056228: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:31:24.056236: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:31:24.056244: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:31:24.056252: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:31:24.056259: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:31:24.056267: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:31:24.056275: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:31:24.056282: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:31:24.056290: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:31:24.056297: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:31:24.056315: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:31:24.056323: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:31:24.056331: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:31:24.056339: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:31:24.056346: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:31:24.056354: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:31:24.056361: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:31:24.056369: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:31:24.056376: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:31:24.056384: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:31:24.056392: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:31:24.056400: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:31:24.056407: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:31:24.056415: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:31:24.056422: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:31:24.056430: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:31:24.056438: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:31:24.056446: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:31:24.056453: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:31:24.056462: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:31:24.056469: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:31:24.056477: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:31:24.056484: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:31:24.056492: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:31:24.056499: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:31:24.056508: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:31:24.056516: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:31:24.056524: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:31:24.056532: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:31:24.056539: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:31:24.056547: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:31:24.056554: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:31:24.056562: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:31:24.056570: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:31:24.056577: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:31:24.056589: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:31:24.056597: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:31:24.056605: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:31:24.056612: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:31:24.056620: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:31:24.056627: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:31:24.056635: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:31:24.056643: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:31:24.056650: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:31:24.056658: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:31:24.056665: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:31:24.056673: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:31:24.056681: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:31:24.056688: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:31:24.056696: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:31:24.056703: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:31:24.056711: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:31:24.056719: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:31:24.056726: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:31:24.056734: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:31:24.056742: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:31:24.056751: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:31:24.056759: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:31:24.056766: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:31:24.056774: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:31:24.056781: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:31:24.056789: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:31:24.056796: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:31:24.056805: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:31:24.056813: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:31:24.056821: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:31:24.056829: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:31:24.056837: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:31:24.056845: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:31:24.056853: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:31:24.056864: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:31:24.056872: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:31:24.056880: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:31:24.056915: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:31:24.056927: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:31:24.056935: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:31:24.056942: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:31:24.056950: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:31:24.056957: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:31:24.056965: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:31:24.056973: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:31:24.056980: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:31:24.056988: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:31:24.056995: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:31:24.057003: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:31:24.057010: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:31:24.057018: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:31:24.057025: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:31:24.057033: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:31:24.057041: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:31:24.057048: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:31:24.057056: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:31:24.057064: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:31:24.057073: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:31:24.057081: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:31:24.057089: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:31:24.057097: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:31:24.057105: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:31:24.057112: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:31:24.057120: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:31:24.057127: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:31:24.057135: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:31:24.057143: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:31:24.057150: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:31:24.057167: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:31:24.057178: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:31:24.057188: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:31:24.057198: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:31:24.057208: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:31:24.057218: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:31:24.057228: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:31:24.057238: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:31:24.057248: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:31:24.057257: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:31:24.057267: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:31:24.057277: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:31:24.057287: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:31:24.057297: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:31:24.057311: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152375808
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:31:24.057335: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:31:24.057359: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame850.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2327.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1882.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2213.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1695.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2445.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1662.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2801.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1634.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2147.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame530.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame183.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame679.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame201.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame571.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame654.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame225.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame629.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame307.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame687.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:31:37.994063: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:31:38.328562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:31:38.539164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:31:38.749565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:31:38.967246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:31:38.967602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:31:38.967681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:31:38.967690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:31:38.967700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:31:38.967704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:31:38.967709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:31:38.967723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:31:38.967729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:31:38.967734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:31:38.967739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:31:50.720282: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:31:50.720720: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:31:50.720753: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720769: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:31:50.720782: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720797: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:31:50.720812: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:31:50.720825: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720840: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:31:50.720852: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720866: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:31:50.720880: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:31:50.720891: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720905: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:31:50.720927: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720940: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720953: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720969: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:31:50.720980: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.720993: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.721005: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.721016: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:31:50.721029: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:31:50.721050: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:31:50.721064: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:31:50.721074: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:31:50.721083: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:31:50.721091: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:31:50.721099: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:31:50.721107: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:31:50.721115: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:31:50.721124: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:31:50.721132: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:31:50.721140: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:31:50.721148: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:31:50.721156: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:31:50.721165: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:31:50.721173: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:31:50.721181: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:31:50.721189: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:31:50.721202: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:31:50.721211: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:31:50.721219: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:31:50.721228: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:31:50.721236: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:31:50.721244: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:31:50.721253: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:31:50.721261: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:31:50.721269: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:31:50.721278: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:31:50.721286: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:31:50.721294: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:31:50.721303: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:31:50.721312: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:31:50.721320: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:31:50.721328: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:31:50.721336: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:31:50.721344: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:31:50.721353: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:31:50.721362: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:31:50.721371: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:31:50.721381: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:31:50.721389: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:31:50.721398: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:31:50.721406: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:31:50.721415: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:31:50.721423: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:31:50.721432: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:31:50.721440: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:31:50.721449: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:31:50.721457: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:31:50.721466: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:31:50.721474: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:31:50.721483: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:31:50.721491: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:31:50.721503: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:31:50.721513: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:31:50.721521: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:31:50.721530: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:31:50.721538: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:31:50.721547: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:31:50.721555: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:31:50.721564: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:31:50.721572: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:31:50.721581: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:31:50.721589: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:31:50.721598: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:31:50.721606: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:31:50.721615: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:31:50.721624: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:31:50.721633: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:31:50.721642: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:31:50.721651: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:31:50.721659: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:31:50.721668: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:31:50.721676: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:31:50.721685: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:31:50.721694: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:31:50.721703: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:31:50.721712: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:31:50.721721: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:31:50.721730: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:31:50.721738: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:31:50.721747: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:31:50.721756: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:31:50.721765: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:31:50.721773: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:31:50.721782: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:31:50.721790: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:31:50.721799: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:31:50.721811: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:31:50.721820: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:31:50.721828: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:31:50.721837: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:31:50.721845: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:31:50.721854: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:31:50.721862: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:31:50.721871: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:31:50.721879: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:31:50.721888: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:31:50.721896: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:31:50.721905: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:31:50.721913: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:31:50.721922: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:31:50.721931: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:31:50.721939: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:31:50.721948: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:31:50.721958: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:31:50.721967: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:31:50.721976: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:31:50.721985: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:31:50.721994: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:31:50.722002: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:31:50.722011: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:31:50.722019: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:31:50.722028: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:31:50.722037: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:31:50.722045: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:31:50.722058: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:31:50.722070: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:31:50.722081: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:31:50.722092: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:31:50.722103: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:31:50.722114: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:31:50.722125: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:31:50.722140: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:31:50.722151: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:31:50.722162: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:31:50.722173: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:31:50.722184: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:31:50.722195: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:31:50.722206: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:31:50.722221: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152378112
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:31:50.722246: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:31:50.722270: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame92.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1747.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2780.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2133.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1872.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2227.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame977.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2707.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1774.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame452.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame675.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame702.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame293.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame6.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame645.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame249.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame677.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame307.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame219.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:32:02.025271: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:32:02.320542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:32:02.513611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:32:02.717030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:32:02.904331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:32:02.904699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:32:02.904774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:32:02.904782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:32:02.904787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:32:02.904791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:32:02.904795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:32:02.904805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:32:02.904810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:32:02.904820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:32:02.904824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:32:14.391231: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:32:14.391334: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:32:14.391353: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391366: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:32:14.391379: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391392: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:32:14.391406: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:32:14.391418: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391433: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:32:14.391444: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391457: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:32:14.391470: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:32:14.391481: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391493: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:32:14.391504: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391515: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391527: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391549: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:32:14.391561: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391573: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391584: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391595: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:14.391607: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:32:14.391626: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:32:14.391638: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:32:14.391646: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:32:14.391654: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:32:14.391661: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:32:14.391669: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:32:14.391676: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:32:14.391684: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:32:14.391691: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:32:14.391699: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:32:14.391706: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:32:14.391713: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:32:14.391721: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:32:14.391728: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:32:14.391736: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:32:14.391743: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:32:14.391750: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:32:14.391758: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:32:14.391765: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:32:14.391773: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:32:14.391781: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:32:14.391788: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:32:14.391796: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:32:14.391803: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:32:14.391815: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:32:14.391823: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:32:14.391831: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:32:14.391839: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:32:14.391846: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:32:14.391854: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:32:14.391862: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:32:14.391869: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:32:14.391877: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:32:14.391884: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:32:14.391892: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:32:14.391899: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:32:14.391907: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:32:14.391916: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:32:14.391923: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:32:14.391931: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:32:14.391938: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:32:14.391946: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:32:14.391953: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:32:14.391961: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:32:14.391968: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:32:14.391976: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:32:14.391983: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:32:14.391991: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:32:14.391998: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:32:14.392006: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:32:14.392013: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:32:14.392021: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:32:14.392028: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:32:14.392036: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:32:14.392043: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:32:14.392050: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:32:14.392058: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:32:14.392065: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:32:14.392073: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:32:14.392085: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:32:14.392092: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:32:14.392100: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:32:14.392107: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:32:14.392115: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:32:14.392122: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:32:14.392130: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:32:14.392138: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:32:14.392147: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:32:14.392154: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:32:14.392162: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:32:14.392170: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:32:14.392177: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:32:14.392185: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:32:14.392192: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:32:14.392200: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:32:14.392208: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:32:14.392218: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:32:14.392227: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:32:14.392236: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:32:14.392243: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:32:14.392252: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:32:14.392260: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:32:14.392268: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:32:14.392276: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:32:14.392284: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:32:14.392291: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:32:14.392299: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:32:14.392307: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:32:14.392314: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:32:14.392322: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:32:14.392330: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:32:14.392337: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:32:14.392345: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:32:14.392353: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:32:14.392364: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:32:14.392372: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:32:14.392380: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:32:14.392388: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:32:14.392395: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:32:14.392403: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:32:14.392411: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:32:14.392419: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:32:14.392427: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:32:14.392435: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:32:14.392444: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:32:14.392452: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:32:14.392460: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:32:14.392468: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:32:14.392476: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:32:14.392483: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:32:14.392491: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:32:14.392499: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:32:14.392507: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:32:14.392515: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:32:14.392522: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:32:14.392535: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:32:14.392545: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:32:14.392555: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:32:14.392564: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:32:14.392574: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:32:14.392584: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:32:14.392594: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:32:14.392604: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:32:14.392614: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:32:14.392623: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:32:14.392633: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:32:14.392643: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:32:14.392658: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:32:14.392668: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:32:14.392682: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152471296
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:32:14.392707: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:32:14.392730: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2739.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1999.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1010.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1579.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2713.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2081.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2074.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2445.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2405.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1584.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame674.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame650.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame645.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame676.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame293.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame276.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame158.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame726.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame739.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame208.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:32:25.786222: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:32:26.091997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:32:26.276241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:32:26.497670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:32:26.706981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:32:26.707350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:32:26.707475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:32:26.707485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:32:26.707490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:32:26.707494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:32:26.707498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:32:26.707508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:32:26.707514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:32:26.707519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:32:26.707523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:32:38.366496: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:32:38.367246: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:32:38.367317: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367335: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:32:38.367348: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367363: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:32:38.367378: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:32:38.367391: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367406: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:32:38.367418: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367432: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:32:38.367445: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:32:38.367457: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367470: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:32:38.367481: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367492: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367504: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367519: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:32:38.367530: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367543: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367554: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367570: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:32:38.367582: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:32:38.367602: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:32:38.367615: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:32:38.367624: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:32:38.367632: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:32:38.367639: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:32:38.367647: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:32:38.367654: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:32:38.367662: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:32:38.367669: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:32:38.367677: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:32:38.367684: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:32:38.367692: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:32:38.367699: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:32:38.367707: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:32:38.367714: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:32:38.367722: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:32:38.367729: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:32:38.367737: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:32:38.367744: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:32:38.367752: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:32:38.367760: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:32:38.367767: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:32:38.367775: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:32:38.367782: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:32:38.367790: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:32:38.367797: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:32:38.367806: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:32:38.367813: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:32:38.367821: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:32:38.367828: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:32:38.367841: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:32:38.367849: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:32:38.367857: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:32:38.367864: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:32:38.367872: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:32:38.367879: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:32:38.367888: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:32:38.367896: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:32:38.367904: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:32:38.367911: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:32:38.367919: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:32:38.367926: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:32:38.367934: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:32:38.367942: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:32:38.367949: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:32:38.367957: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:32:38.367964: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:32:38.367972: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:32:38.367979: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:32:38.367987: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:32:38.367994: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:32:38.368002: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:32:38.368009: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:32:38.368017: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:32:38.368024: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:32:38.368032: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:32:38.368039: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:32:38.368047: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:32:38.368054: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:32:38.368062: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:32:38.368069: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:32:38.368076: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:32:38.368084: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:32:38.368091: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:32:38.368099: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:32:38.368111: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:32:38.368120: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:32:38.368128: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:32:38.368136: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:32:38.368143: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:32:38.368151: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:32:38.368158: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:32:38.368166: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:32:38.368173: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:32:38.368181: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:32:38.368190: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:32:38.368198: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:32:38.368206: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:32:38.368213: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:32:38.368221: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:32:38.368229: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:32:38.368237: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:32:38.368245: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:32:38.368252: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:32:38.368260: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:32:38.368268: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:32:38.368275: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:32:38.368283: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:32:38.368290: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:32:38.368298: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:32:38.368306: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:32:38.368313: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:32:38.368321: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:32:38.368328: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:32:38.368336: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:32:38.368343: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:32:38.368351: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:32:38.368358: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:32:38.368366: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:32:38.368373: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:32:38.368385: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:32:38.368393: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:32:38.368401: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:32:38.368409: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:32:38.368418: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:32:38.368426: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:32:38.368434: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:32:38.368442: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:32:38.368450: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:32:38.368458: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:32:38.368465: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:32:38.368473: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:32:38.368481: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:32:38.368489: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:32:38.368496: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:32:38.368508: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:32:38.368519: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:32:38.368529: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:32:38.368539: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:32:38.368548: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:32:38.368558: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:32:38.368568: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:32:38.368579: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:32:38.368589: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:32:38.368599: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:32:38.368608: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:32:38.368618: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:32:38.368628: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:32:38.368638: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:32:38.368652: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152380416
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:32:38.368675: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:32:38.368697: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2478.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1461.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2713.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1276.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1532.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1574.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1774.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame92.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame969.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2587.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame666.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame311.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame646.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame727.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame593.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame513.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame734.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame330.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame295.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame608.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:32:52.564765: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:32:52.849416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:32:53.052605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:32:53.258269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:32:53.456081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:32:53.456435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:32:53.456511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:32:53.456519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:32:53.456524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:32:53.456528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:32:53.456532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:32:53.456542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:32:53.456547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:32:53.456553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:32:53.456557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:33:05.053024: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:33:05.054068: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:33:05.054109: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054125: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:33:05.054137: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054162: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:33:05.054177: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:33:05.054189: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054204: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:33:05.054215: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054229: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:33:05.054242: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:33:05.054253: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054266: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:33:05.054277: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054288: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054300: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054315: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:33:05.054326: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054338: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054349: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054360: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:05.054372: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:33:05.054392: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:33:05.054404: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:33:05.054417: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:33:05.054425: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:33:05.054433: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:33:05.054440: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:33:05.054448: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:33:05.054456: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:33:05.054463: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:33:05.054470: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:33:05.054478: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:33:05.054485: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:33:05.054493: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:33:05.054500: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:33:05.054508: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:33:05.054515: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:33:05.054523: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:33:05.054530: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:33:05.054538: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:33:05.054545: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:33:05.054553: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:33:05.054561: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:33:05.054569: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:33:05.054576: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:33:05.054584: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:33:05.054591: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:33:05.054600: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:33:05.054607: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:33:05.054615: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:33:05.054622: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:33:05.054631: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:33:05.054638: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:33:05.054646: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:33:05.054685: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:33:05.054696: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:33:05.054704: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:33:05.054712: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:33:05.054726: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:33:05.054735: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:33:05.054743: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:33:05.054751: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:33:05.054758: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:33:05.054766: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:33:05.054773: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:33:05.054781: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:33:05.054789: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:33:05.054796: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:33:05.054804: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:33:05.054812: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:33:05.054819: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:33:05.054827: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:33:05.054835: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:33:05.054842: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:33:05.054850: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:33:05.054857: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:33:05.054865: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:33:05.054873: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:33:05.054880: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:33:05.054888: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:33:05.054895: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:33:05.054903: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:33:05.054911: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:33:05.054918: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:33:05.054926: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:33:05.054933: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:33:05.054941: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:33:05.054950: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:33:05.054959: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:33:05.054967: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:33:05.054974: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:33:05.054982: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:33:05.054996: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:33:05.055004: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:33:05.055012: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:33:05.055021: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:33:05.055031: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:33:05.055039: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:33:05.055047: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:33:05.055055: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:33:05.055063: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:33:05.055071: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:33:05.055079: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:33:05.055087: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:33:05.055095: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:33:05.055103: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:33:05.055110: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:33:05.055118: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:33:05.055126: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:33:05.055133: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:33:05.055141: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:33:05.055148: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:33:05.055156: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:33:05.055164: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:33:05.055171: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:33:05.055179: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:33:05.055186: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:33:05.055194: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:33:05.055202: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:33:05.055209: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:33:05.055217: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:33:05.055224: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:33:05.055232: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:33:05.055240: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:33:05.055248: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:33:05.055257: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:33:05.055266: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:33:05.055277: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:33:05.055286: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:33:05.055294: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:33:05.055301: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:33:05.055309: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:33:05.055317: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:33:05.055325: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:33:05.055333: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:33:05.055340: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:33:05.055353: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:33:05.055364: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:33:05.055373: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:33:05.055383: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:33:05.055393: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:33:05.055402: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:33:05.055412: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:33:05.055422: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:33:05.055432: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:33:05.055441: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:33:05.055451: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:33:05.055461: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:33:05.055471: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:33:05.055480: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:33:05.055494: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152375040
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:33:05.055520: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:33:05.055545: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2406.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame109.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1404.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1741.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1507.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2495.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2726.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2405.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1254.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2154.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame151.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame516.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame586.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame281.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame589.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame206.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame659.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame270.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame224.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame295.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:33:16.487632: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:33:16.802358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:33:16.994420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:33:17.195293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:33:17.395899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:33:17.396248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:33:17.396323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:33:17.396331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:33:17.396336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:33:17.396340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:33:17.396344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:33:17.396356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:33:17.396362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:33:17.396366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:33:17.396371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:33:28.941636: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:33:28.942102: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:33:28.942128: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942142: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:33:28.942155: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942169: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:33:28.942183: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:33:28.942195: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942210: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:33:28.942232: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942247: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:33:28.942260: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:33:28.942271: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942283: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:33:28.942294: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942305: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942318: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942332: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:33:28.942343: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942355: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942366: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942377: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:28.942389: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:33:28.942410: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:33:28.942422: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:33:28.942431: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:33:28.942439: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:33:28.942446: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:33:28.942454: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:33:28.942461: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:33:28.942468: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:33:28.942480: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:33:28.942488: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:33:28.942495: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:33:28.942503: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:33:28.942510: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:33:28.942518: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:33:28.942525: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:33:28.942532: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:33:28.942540: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:33:28.942547: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:33:28.942555: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:33:28.942562: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:33:28.942570: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:33:28.942577: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:33:28.942585: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:33:28.942592: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:33:28.942600: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:33:28.942607: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:33:28.942615: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:33:28.942623: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:33:28.942630: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:33:28.942638: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:33:28.942646: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:33:28.942681: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:33:28.942692: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:33:28.942699: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:33:28.942707: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:33:28.942714: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:33:28.942722: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:33:28.942731: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:33:28.942738: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:33:28.942746: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:33:28.942753: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:33:28.942761: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:33:28.942768: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:33:28.942780: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:33:28.942788: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:33:28.942795: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:33:28.942803: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:33:28.942810: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:33:28.942818: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:33:28.942825: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:33:28.942832: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:33:28.942840: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:33:28.942847: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:33:28.942855: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:33:28.942862: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:33:28.942870: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:33:28.942877: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:33:28.942885: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:33:28.942892: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:33:28.942900: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:33:28.942907: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:33:28.942914: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:33:28.942922: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:33:28.942929: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:33:28.942937: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:33:28.942944: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:33:28.942952: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:33:28.942960: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:33:28.942968: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:33:28.942975: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:33:28.942983: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:33:28.942990: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:33:28.942998: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:33:28.943005: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:33:28.943013: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:33:28.943022: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:33:28.943030: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:33:28.943037: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:33:28.943049: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:33:28.943057: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:33:28.943065: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:33:28.943073: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:33:28.943081: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:33:28.943088: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:33:28.943096: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:33:28.943103: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:33:28.943111: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:33:28.943118: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:33:28.943125: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:33:28.943133: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:33:28.943140: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:33:28.943148: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:33:28.943155: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:33:28.943162: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:33:28.943170: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:33:28.943177: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:33:28.943185: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:33:28.943192: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:33:28.943199: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:33:28.943207: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:33:28.943214: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:33:28.943222: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:33:28.943230: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:33:28.943237: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:33:28.943246: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:33:28.943254: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:33:28.943262: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:33:28.943269: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:33:28.943277: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:33:28.943284: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:33:28.943292: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:33:28.943299: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:33:28.943311: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:33:28.943319: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:33:28.943326: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:33:28.943340: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:33:28.943350: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:33:28.943360: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:33:28.943369: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:33:28.943379: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:33:28.943388: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:33:28.943398: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:33:28.943408: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:33:28.943418: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:33:28.943428: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:33:28.943437: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:33:28.943447: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:33:28.943457: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:33:28.943467: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:33:28.943481: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152386048
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:33:28.943505: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:33:28.943527: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2778.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2801.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2478.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1553.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2673.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame855.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2676.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1644.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1574.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1753.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame282.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame317.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame702.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame155.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame250.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame594.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame269.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame643.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame631.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame522.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:33:40.209289: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:33:40.524124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:33:40.728848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:33:40.962467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:33:41.158094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:33:41.158391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:33:41.158449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:33:41.158455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:33:41.158458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:33:41.158461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:33:41.158464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:33:41.158476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:33:41.158480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:33:41.158484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:33:41.158487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:33:52.693049: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:33:52.694141: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:33:52.694172: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694188: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:33:52.694200: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694214: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:33:52.694229: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:33:52.694241: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694256: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:33:52.694268: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694282: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:33:52.694296: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:33:52.694320: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694333: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:33:52.694345: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694356: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694368: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694383: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:33:52.694394: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694406: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694417: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694428: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:33:52.694440: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:33:52.694460: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:33:52.694473: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:33:52.694481: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:33:52.694489: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:33:52.694496: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:33:52.694503: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:33:52.694511: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:33:52.694518: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:33:52.694526: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:33:52.694533: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:33:52.694541: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:33:52.694548: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:33:52.694555: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:33:52.694563: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:33:52.694575: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:33:52.694583: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:33:52.694590: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:33:52.694598: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:33:52.694605: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:33:52.694613: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:33:52.694621: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:33:52.694628: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:33:52.694636: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:33:52.694643: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:33:52.694651: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:33:52.694705: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:33:52.694714: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:33:52.694722: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:33:52.694729: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:33:52.694737: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:33:52.694745: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:33:52.694753: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:33:52.694760: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:33:52.694768: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:33:52.694775: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:33:52.694783: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:33:52.694791: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:33:52.694799: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:33:52.694807: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:33:52.694815: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:33:52.694822: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:33:52.694830: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:33:52.694838: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:33:52.694845: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:33:52.694853: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:33:52.694860: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:33:52.694868: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:33:52.694875: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:33:52.694883: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:33:52.694895: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:33:52.694903: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:33:52.694911: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:33:52.694918: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:33:52.694926: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:33:52.694934: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:33:52.694941: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:33:52.694949: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:33:52.694956: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:33:52.694964: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:33:52.694971: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:33:52.694979: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:33:52.694986: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:33:52.694994: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:33:52.695001: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:33:52.695009: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:33:52.695016: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:33:52.695024: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:33:52.695033: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:33:52.695040: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:33:52.695048: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:33:52.695055: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:33:52.695063: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:33:52.695070: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:33:52.695078: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:33:52.695086: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:33:52.695095: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:33:52.695103: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:33:52.695111: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:33:52.695118: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:33:52.695126: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:33:52.695134: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:33:52.695142: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:33:52.695150: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:33:52.695157: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:33:52.695169: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:33:52.695177: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:33:52.695184: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:33:52.695192: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:33:52.695199: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:33:52.695207: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:33:52.695214: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:33:52.695222: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:33:52.695229: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:33:52.695237: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:33:52.695244: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:33:52.695252: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:33:52.695259: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:33:52.695267: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:33:52.695275: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:33:52.695282: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:33:52.695290: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:33:52.695298: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:33:52.695305: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:33:52.695313: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:33:52.695322: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:33:52.695330: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:33:52.695338: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:33:52.695346: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:33:52.695354: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:33:52.695361: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:33:52.695369: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:33:52.695377: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:33:52.695384: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:33:52.695392: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:33:52.695399: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:33:52.695413: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:33:52.695424: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:33:52.695434: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:33:52.695443: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:33:52.695457: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:33:52.695468: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:33:52.695477: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:33:52.695488: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:33:52.695497: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:33:52.695507: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:33:52.695516: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:33:52.695527: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:33:52.695537: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:33:52.695546: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:33:52.695560: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152377600
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:33:52.695585: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:33:52.695607: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1652.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1695.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2778.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame967.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2613.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1633.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1940.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1404.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1763.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame281.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame312.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame282.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame659.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame226.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame584.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame194.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame629.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame176.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame589.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:34:07.084583: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:34:07.389937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:34:07.599948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:34:07.823409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:34:08.010954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:34:08.011319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:34:08.011398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:34:08.011405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:34:08.011410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:34:08.011414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:34:08.011419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:34:08.011431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:34:08.011442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:34:08.011447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:34:08.011452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:34:19.446371: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:34:19.446929: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:34:19.446978: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.446994: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:34:19.447007: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447022: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:34:19.447036: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:34:19.447050: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447065: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:34:19.447076: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447090: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:34:19.447104: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:34:19.447115: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447128: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:34:19.447139: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447151: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447173: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447189: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:34:19.447201: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447213: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447225: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447236: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:19.447248: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:34:19.447269: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 15.26MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:34:19.447282: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:34:19.447291: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:34:19.447299: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:34:19.447307: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:34:19.447315: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:34:19.447322: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:34:19.447330: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:34:19.447338: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:34:19.447345: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:34:19.447353: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:34:19.447360: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:34:19.447368: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:34:19.447376: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:34:19.447383: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:34:19.447391: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:34:19.447399: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:34:19.447406: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:34:19.447414: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:34:19.447421: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:34:19.447429: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:34:19.447442: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:34:19.447450: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:34:19.447458: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:34:19.447465: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:34:19.447473: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:34:19.447481: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:34:19.447489: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:34:19.447497: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:34:19.447504: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:34:19.447513: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:34:19.447520: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:34:19.447528: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:34:19.447536: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:34:19.447543: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:34:19.447551: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:34:19.447559: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:34:19.447568: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:34:19.447576: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:34:19.447584: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:34:19.447591: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:34:19.447599: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:34:19.447607: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:34:19.447614: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:34:19.447622: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:34:19.447629: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:34:19.447637: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:34:19.447645: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:34:19.447652: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:34:19.447660: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:34:19.447668: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:34:19.447675: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:34:19.447683: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:34:19.447691: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:34:19.447698: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:34:19.447706: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:34:19.447718: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:34:19.447726: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:34:19.447734: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:34:19.447741: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:34:19.447749: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:34:19.447757: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:34:19.447764: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:34:19.447772: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:34:19.447780: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:34:19.447787: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:34:19.447796: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:34:19.447804: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:34:19.447812: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:34:19.447820: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:34:19.447827: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:34:19.447835: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:34:19.447843: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:34:19.447850: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:34:19.447859: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:34:19.447867: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:34:19.447875: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:34:19.447883: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:34:19.447891: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:34:19.447899: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:34:19.447907: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:34:19.447915: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:34:19.447923: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:34:19.447931: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:34:19.447938: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:34:19.447946: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:34:19.447954: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:34:19.447962: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:34:19.447969: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:34:19.447977: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:34:19.447990: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:34:19.447998: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:34:19.448006: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:34:19.448013: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:34:19.448021: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:34:19.448029: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:34:19.448036: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:34:19.448044: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:34:19.448052: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:34:19.448059: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:34:19.448067: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:34:19.448075: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:34:19.448083: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:34:19.448091: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:34:19.448100: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:34:19.448108: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:34:19.448116: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:34:19.448124: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:34:19.448132: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:34:19.448139: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:34:19.448147: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:34:19.448155: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:34:19.448163: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:34:19.448170: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:34:19.448178: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:34:19.448191: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:34:19.448201: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:34:19.448210: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:34:19.448220: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:34:19.448230: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:34:19.448240: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:34:19.448250: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:34:19.448260: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:34:19.448270: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:34:19.448279: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:34:19.448295: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:34:19.448306: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:34:19.448316: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:34:19.448326: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:34:19.448340: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152077568
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:34:19.448365: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:34:19.448390: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2422.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1464.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2223.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame426.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2666.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2732.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2187.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1741.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2813.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2801.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame311.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame585.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame245.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame605.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame195.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame695.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame519.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame643.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame638.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame219.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:34:31.267398: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:34:31.573278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:34:31.775724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:34:31.992713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:34:32.198003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:34:32.198353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:34:32.198427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:34:32.198435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:34:32.198439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:34:32.198443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:34:32.198447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:34:32.198463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:34:32.198469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:34:32.198474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:34:32.198479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:34:43.727387: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:34:43.727966: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:34:43.728012: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728028: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:34:43.728042: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728058: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:34:43.728073: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:34:43.728087: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728103: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:34:43.728115: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728130: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:34:43.728144: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:34:43.728156: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728170: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:34:43.728182: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728193: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728207: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728222: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:34:43.728234: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728259: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728272: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728283: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:34:43.728296: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:34:43.728317: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 300.0KiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:34:43.728331: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:34:43.728341: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:34:43.728349: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:34:43.728357: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:34:43.728365: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:34:43.728373: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:34:43.728381: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:34:43.728389: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:34:43.728397: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:34:43.728405: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:34:43.728413: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:34:43.728421: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:34:43.728428: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:34:43.728436: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:34:43.728444: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:34:43.728452: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:34:43.728460: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:34:43.728468: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:34:43.728476: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:34:43.728484: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:34:43.728492: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:34:43.728500: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:34:43.728508: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:34:43.728516: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:34:43.728524: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:34:43.728532: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:34:43.728550: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:34:43.728559: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:34:43.728568: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:34:43.728577: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:34:43.728585: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:34:43.728593: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:34:43.728601: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:34:43.728609: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:34:43.728617: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:34:43.728625: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:34:43.728634: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:34:43.728643: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:34:43.728651: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:34:43.728659: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:34:43.728667: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:34:43.728675: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:34:43.728682: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:34:43.728690: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:34:43.728698: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:34:43.728707: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:34:43.728715: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:34:43.728723: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:34:43.728730: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:34:43.728738: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:34:43.728746: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:34:43.728754: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:34:43.728762: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:34:43.728770: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:34:43.728778: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:34:43.728786: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:34:43.728794: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:34:43.728802: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:34:43.728810: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:34:43.728818: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:34:43.728826: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:34:43.728843: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:34:43.728851: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:34:43.728859: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:34:43.728867: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:34:43.728876: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:34:43.728885: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:34:43.728893: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:34:43.728902: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:34:43.728909: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:34:43.728918: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:34:43.728925: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:34:43.728933: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:34:43.728942: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:34:43.728951: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:34:43.728959: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:34:43.728967: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:34:43.728975: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:34:43.728983: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:34:43.728992: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:34:43.729000: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:34:43.729009: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:34:43.729017: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:34:43.729025: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:34:43.729033: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:34:43.729041: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:34:43.729048: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:34:43.729056: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:34:43.729064: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:34:43.729072: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:34:43.729080: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:34:43.729088: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:34:43.729096: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:34:43.729104: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:34:43.729112: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:34:43.729119: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:34:43.729131: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:34:43.729140: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:34:43.729148: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:34:43.729156: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:34:43.729164: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:34:43.729172: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:34:43.729180: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:34:43.729189: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:34:43.729198: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:34:43.729206: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:34:43.729214: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:34:43.729222: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:34:43.729230: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:34:43.729238: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:34:43.729246: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:34:43.729255: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:34:43.729263: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:34:43.729270: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:34:43.729283: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:34:43.729294: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:34:43.729305: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:34:43.729316: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:34:43.729326: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:34:43.729337: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:34:43.729347: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:34:43.729358: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:34:43.729369: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:34:43.729379: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:34:43.729389: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:34:43.729400: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:34:43.729411: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:34:43.729421: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:34:43.729436: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152375552
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:34:43.729466: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:34:43.729492: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2187.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1565.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2702.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2676.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2621.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2110.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1032.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2335.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1747.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1662.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame279.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame701.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame517.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame306.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame630.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame684.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame737.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame294.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame199.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame670.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:34:55.608216: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:34:55.908096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:34:56.095289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:34:56.306786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:34:56.511052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:34:56.511433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:34:56.511511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:34:56.511519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:34:56.511523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:34:56.511528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:34:56.511532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:34:56.511543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:34:56.511549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:34:56.511554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:34:56.511559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:35:08.017695: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:35:08.018197: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:35:08.018229: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018245: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:35:08.018269: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018285: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:35:08.018300: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:35:08.018314: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018329: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:35:08.018342: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018357: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:35:08.018372: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:35:08.018384: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018397: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:35:08.018410: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018422: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018435: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018451: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:35:08.018463: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018476: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018489: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018501: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:08.018518: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:35:08.018540: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 15.26MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:35:08.018553: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:35:08.018562: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:35:08.018570: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:35:08.018578: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:35:08.018587: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:35:08.018595: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:35:08.018603: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:35:08.018611: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:35:08.018619: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:35:08.018627: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:35:08.018635: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:35:08.018643: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:35:08.018651: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:35:08.019009: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:35:08.019020: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:35:08.019028: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:35:08.019036: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:35:08.019045: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:35:08.019053: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:35:08.019062: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:35:08.019070: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:35:08.019078: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:35:08.019086: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:35:08.019094: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:35:08.019102: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:35:08.019111: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:35:08.019119: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:35:08.019127: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:35:08.019135: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:35:08.019144: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:35:08.019152: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:35:08.019160: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:35:08.019182: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:35:08.019191: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:35:08.019200: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:35:08.019208: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:35:08.019218: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:35:08.019226: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:35:08.019252: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:35:08.019260: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:35:08.019267: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:35:08.019274: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:35:08.019282: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:35:08.019289: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:35:08.019297: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:35:08.019304: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:35:08.019312: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:35:08.019319: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:35:08.019327: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:35:08.019334: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:35:08.019342: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:35:08.019349: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:35:08.019356: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:35:08.019364: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:35:08.019371: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:35:08.019379: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:35:08.019386: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:35:08.019394: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:35:08.019401: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:35:08.019408: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:35:08.019416: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:35:08.019423: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:35:08.019431: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:35:08.019438: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:35:08.019446: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:35:08.019454: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:35:08.019462: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:35:08.019473: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:35:08.019481: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:35:08.019489: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:35:08.019496: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:35:08.019504: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:35:08.019511: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:35:08.019519: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:35:08.019527: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:35:08.019536: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:35:08.019543: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:35:08.019551: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:35:08.019559: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:35:08.019567: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:35:08.019575: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:35:08.019582: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:35:08.019590: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:35:08.019597: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:35:08.019605: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:35:08.019612: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:35:08.019620: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:35:08.019627: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:35:08.019635: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:35:08.019642: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:35:08.019650: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:35:08.019657: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:35:08.019664: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:35:08.019672: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:35:08.019679: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:35:08.019687: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:35:08.019694: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:35:08.019702: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:35:08.019709: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:35:08.019717: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:35:08.019724: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:35:08.019732: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:35:08.019744: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:35:08.019753: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:35:08.019761: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:35:08.019769: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:35:08.019776: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:35:08.019784: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:35:08.019792: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:35:08.019799: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:35:08.019807: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:35:08.019814: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:35:08.019822: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:35:08.019829: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:35:08.019845: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:35:08.019856: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:35:08.019866: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:35:08.019876: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:35:08.019886: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:35:08.019896: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:35:08.019907: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:35:08.019917: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:35:08.019927: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:35:08.019937: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:35:08.019947: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:35:08.019957: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:35:08.019967: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:35:08.019977: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:35:08.019991: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152218624
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:35:08.020014: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:35:08.020035: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032']
Generating filenames
all_filenames:  [array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2249.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1019.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame1662.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2104.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame970.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame145.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2111.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2666.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame2672.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/off/frame855.jpg'],
      dtype='<U70'), array(['/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame151.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame596.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame630.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame154.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame289.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame518.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame590.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame6.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame711.jpg',
       '/home/ml1323/project/robert_data/DISFA/kshot/0/SN032/on/frame586.jpg'],
      dtype='<U70')]
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-13 09:35:22.717302: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-13 09:35:23.054618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 413.12MiB
2018-07-13 09:35:23.268220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:35:23.492420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 504.12MiB
2018-07-13 09:35:23.697903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 506.00MiB
2018-07-13 09:35:23.698384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-13 09:35:23.698504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-13 09:35:23.698516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-13 09:35:23.698523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-13 09:35:23.698530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-13 09:35:23.698537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-13 09:35:23.698554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-13 09:35:23.698563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-13 09:35:23.698571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-13 09:35:23.698579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-13 09:35:35.210445: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 93.75MiB.  Current allocation summary follows.
2018-07-13 09:35:35.211004: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (256): 	Total Chunks: 81, Chunks in use: 81. 20.2KiB allocated for chunks. 20.2KiB in use in bin. 8.9KiB client-requested in use in bin.
2018-07-13 09:35:35.211053: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211069: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2018-07-13 09:35:35.211082: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211095: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4096): 	Total Chunks: 2, Chunks in use: 2. 12.5KiB allocated for chunks. 12.5KiB in use in bin. 12.5KiB client-requested in use in bin.
2018-07-13 09:35:35.211109: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8192): 	Total Chunks: 8, Chunks in use: 7. 82.5KiB allocated for chunks. 66.8KiB in use in bin. 65.6KiB client-requested in use in bin.
2018-07-13 09:35:35.211132: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 25.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211148: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (32768): 	Total Chunks: 5, Chunks in use: 3. 234.2KiB allocated for chunks. 134.2KiB in use in bin. 125.0KiB client-requested in use in bin.
2018-07-13 09:35:35.211160: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211174: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 450.0KiB allocated for chunks. 300.0KiB in use in bin. 300.0KiB client-requested in use in bin.
2018-07-13 09:35:35.211188: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (262144): 	Total Chunks: 3, Chunks in use: 2. 900.0KiB allocated for chunks. 600.0KiB in use in bin. 600.0KiB client-requested in use in bin.
2018-07-13 09:35:35.211199: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211211: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (1048576): 	Total Chunks: 1, Chunks in use: 1. 1.46MiB allocated for chunks. 1.46MiB in use in bin. 1.46MiB client-requested in use in bin.
2018-07-13 09:35:35.211222: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211233: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211245: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0. 13.79MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211260: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (16777216): 	Total Chunks: 5, Chunks in use: 4. 91.26MiB allocated for chunks. 72.95MiB in use in bin. 70.19MiB client-requested in use in bin.
2018-07-13 09:35:35.211271: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211283: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0. 79.92MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211294: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211305: I tensorflow/core/common_runtime/bfc_allocator.cc:627] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2018-07-13 09:35:35.211316: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin for 93.75MiB was 64.00MiB, Chunk State: 
2018-07-13 09:35:35.211335: I tensorflow/core/common_runtime/bfc_allocator.cc:649]   Size: 79.92MiB | Requested Size: 18.31MiB | in_use: 0, prev:   Size: 18.31MiB | Requested Size: 18.31MiB | in_use: 1
2018-07-13 09:35:35.211348: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00000 of size 1280
2018-07-13 09:35:35.211356: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00500 of size 256
2018-07-13 09:35:35.211364: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00600 of size 256
2018-07-13 09:35:35.211371: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00700 of size 256
2018-07-13 09:35:35.211383: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00800 of size 256
2018-07-13 09:35:35.211390: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00900 of size 256
2018-07-13 09:35:35.211398: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00a00 of size 256
2018-07-13 09:35:35.211405: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00b00 of size 256
2018-07-13 09:35:35.211413: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00c00 of size 256
2018-07-13 09:35:35.211420: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00d00 of size 256
2018-07-13 09:35:35.211427: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00e00 of size 256
2018-07-13 09:35:35.211435: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f00f00 of size 256
2018-07-13 09:35:35.211442: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01000 of size 256
2018-07-13 09:35:35.211449: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01100 of size 256
2018-07-13 09:35:35.211457: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01200 of size 256
2018-07-13 09:35:35.211464: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01300 of size 256
2018-07-13 09:35:35.211471: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01400 of size 256
2018-07-13 09:35:35.211478: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01500 of size 256
2018-07-13 09:35:35.211486: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01600 of size 256
2018-07-13 09:35:35.211494: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f01700 of size 8192
2018-07-13 09:35:35.211501: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03700 of size 256
2018-07-13 09:35:35.211508: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03800 of size 256
2018-07-13 09:35:35.211516: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03900 of size 256
2018-07-13 09:35:35.211523: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03a00 of size 256
2018-07-13 09:35:35.211530: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03b00 of size 256
2018-07-13 09:35:35.211538: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f03c00 of size 9728
2018-07-13 09:35:35.211546: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06200 of size 256
2018-07-13 09:35:35.211553: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06300 of size 256
2018-07-13 09:35:35.211560: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06400 of size 256
2018-07-13 09:35:35.211568: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f06500 of size 6400
2018-07-13 09:35:35.211575: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07e00 of size 256
2018-07-13 09:35:35.211583: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f07f00 of size 256
2018-07-13 09:35:35.211590: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08000 of size 256
2018-07-13 09:35:35.211597: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08100 of size 256
2018-07-13 09:35:35.211605: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08200 of size 256
2018-07-13 09:35:35.211613: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f08300 of size 153600
2018-07-13 09:35:35.211621: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f2db00 of size 51200
2018-07-13 09:35:35.211629: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f3a300 of size 51200
2018-07-13 09:35:35.211636: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53300 of size 256
2018-07-13 09:35:35.211649: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53400 of size 256
2018-07-13 09:35:35.211657: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53500 of size 256
2018-07-13 09:35:35.211664: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53600 of size 256
2018-07-13 09:35:35.211672: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53700 of size 256
2018-07-13 09:35:35.211679: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53800 of size 256
2018-07-13 09:35:35.211686: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53900 of size 256
2018-07-13 09:35:35.211694: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f53a00 of size 153600
2018-07-13 09:35:35.211701: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79200 of size 256
2018-07-13 09:35:35.211708: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79300 of size 256
2018-07-13 09:35:35.211715: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79400 of size 256
2018-07-13 09:35:35.211723: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79500 of size 256
2018-07-13 09:35:35.211730: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79600 of size 256
2018-07-13 09:35:35.211737: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79700 of size 256
2018-07-13 09:35:35.211744: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79800 of size 256
2018-07-13 09:35:35.211752: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79900 of size 256
2018-07-13 09:35:35.211759: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79a00 of size 256
2018-07-13 09:35:35.211766: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79b00 of size 256
2018-07-13 09:35:35.211774: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79c00 of size 256
2018-07-13 09:35:35.211781: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79d00 of size 256
2018-07-13 09:35:35.211788: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79e00 of size 256
2018-07-13 09:35:35.211795: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f79f00 of size 256
2018-07-13 09:35:35.211803: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a000 of size 256
2018-07-13 09:35:35.211810: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a100 of size 256
2018-07-13 09:35:35.211817: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a200 of size 256
2018-07-13 09:35:35.211824: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7a300 of size 256
2018-07-13 09:35:35.211832: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b000 of size 256
2018-07-13 09:35:35.211840: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7b100 of size 16128
2018-07-13 09:35:35.211848: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f7f000 of size 35072
2018-07-13 09:35:35.211855: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87900 of size 256
2018-07-13 09:35:35.211863: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87a00 of size 256
2018-07-13 09:35:35.211870: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87b00 of size 256
2018-07-13 09:35:35.211877: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87c00 of size 256
2018-07-13 09:35:35.211884: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87d00 of size 256
2018-07-13 09:35:35.211892: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87e00 of size 256
2018-07-13 09:35:35.211900: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4213f87f00 of size 19200000
2018-07-13 09:35:35.211911: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42151d7700 of size 307200
2018-07-13 09:35:35.211920: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4215222700 of size 18892800
2018-07-13 09:35:35.211927: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216426f00 of size 8192
2018-07-13 09:35:35.211935: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216473f00 of size 8192
2018-07-13 09:35:35.211942: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479e00 of size 256
2018-07-13 09:35:35.211950: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4216479f00 of size 1536000
2018-07-13 09:35:35.211958: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42173bc300 of size 8192
2018-07-13 09:35:35.211965: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421860db00 of size 9728
2018-07-13 09:35:35.211973: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616500 of size 256
2018-07-13 09:35:35.211980: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616600 of size 256
2018-07-13 09:35:35.211987: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616700 of size 256
2018-07-13 09:35:35.211995: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616800 of size 256
2018-07-13 09:35:35.212002: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616900 of size 256
2018-07-13 09:35:35.212009: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616a00 of size 256
2018-07-13 09:35:35.212017: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218616b00 of size 256
2018-07-13 09:35:35.212024: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623400 of size 256
2018-07-13 09:35:35.212031: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623500 of size 256
2018-07-13 09:35:35.212038: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623600 of size 256
2018-07-13 09:35:35.212046: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623700 of size 256
2018-07-13 09:35:35.212053: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623800 of size 256
2018-07-13 09:35:35.212060: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623900 of size 256
2018-07-13 09:35:35.212068: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218623a00 of size 256
2018-07-13 09:35:35.212075: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649300 of size 256
2018-07-13 09:35:35.212082: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649400 of size 256
2018-07-13 09:35:35.212089: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649500 of size 256
2018-07-13 09:35:35.212097: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218649600 of size 6400
2018-07-13 09:35:35.212104: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x421864af00 of size 307200
2018-07-13 09:35:35.212112: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x4218695f00 of size 19200000
2018-07-13 09:35:35.212120: I tensorflow/core/common_runtime/bfc_allocator.cc:661] Chunk at 0x42198e5700 of size 19200000
2018-07-13 09:35:35.212128: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f46b00 of size 51200
2018-07-13 09:35:35.212136: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4213f7a400 of size 3072
2018-07-13 09:35:35.212144: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216428f00 of size 307200
2018-07-13 09:35:35.212151: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4216475f00 of size 16128
2018-07-13 09:35:35.212159: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42165f0f00 of size 14464000
2018-07-13 09:35:35.212170: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x42173be300 of size 19200000
2018-07-13 09:35:35.212178: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218610100 of size 25600
2018-07-13 09:35:35.212186: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218616c00 of size 51200
2018-07-13 09:35:35.212193: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x4218623b00 of size 153600
2018-07-13 09:35:35.212201: I tensorflow/core/common_runtime/bfc_allocator.cc:670] Free at 0x421ab34f00 of size 83800320
2018-07-13 09:35:35.212208: I tensorflow/core/common_runtime/bfc_allocator.cc:676]      Summary of in-use Chunks by size: 
2018-07-13 09:35:35.212220: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 81 Chunks of size 256 totalling 20.2KiB
2018-07-13 09:35:35.212230: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1280 totalling 1.2KiB
2018-07-13 09:35:35.212240: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 6400 totalling 12.5KiB
2018-07-13 09:35:35.212249: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 4 Chunks of size 8192 totalling 32.0KiB
2018-07-13 09:35:35.212259: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 9728 totalling 19.0KiB
2018-07-13 09:35:35.212269: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 16128 totalling 15.8KiB
2018-07-13 09:35:35.212279: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 35072 totalling 34.2KiB
2018-07-13 09:35:35.212288: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 51200 totalling 100.0KiB
2018-07-13 09:35:35.212298: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 153600 totalling 300.0KiB
2018-07-13 09:35:35.212308: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 2 Chunks of size 307200 totalling 600.0KiB
2018-07-13 09:35:35.212317: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 1536000 totalling 1.46MiB
2018-07-13 09:35:35.212327: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 1 Chunks of size 18892800 totalling 18.02MiB
2018-07-13 09:35:35.212337: I tensorflow/core/common_runtime/bfc_allocator.cc:679] 3 Chunks of size 19200000 totalling 54.93MiB
2018-07-13 09:35:35.212346: I tensorflow/core/common_runtime/bfc_allocator.cc:683] Sum Total of in-use chunks: 75.52MiB
2018-07-13 09:35:35.212360: I tensorflow/core/common_runtime/bfc_allocator.cc:685] Stats: 
Limit:                   197263360
InUse:                    79191040
MaxInUse:                152381952
NumAllocs:                     177
MaxAllocSize:             19200000

2018-07-13 09:35:35.212385: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *********************_______*________*********************__________________________________________
2018-07-13 09:35:35.212409: W tensorflow/core/framework/op_kernel.cc:1192] Resource exhausted: OOM when allocating tensor with shape[10,160,240,64]
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1323, in _do_call
    return fn(*args)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1302, in _run_fn
    status, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 118, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 114, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 70, in computeLatentVal
    z, _ = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1272, in predict
    batch_size=batch_size, verbose=verbose)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 945, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1943, in __call__
    feed_dict=feed_dict)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

Caused by op 'Conv2D', defined at:
  File "main.py", line 401, in <module>
    main()
  File "main.py", line 307, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 85, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), (1, self.num_classes))
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 24, in __init__
    emb, shape  = EE.networks.encoder(inp_0, norm=1)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/networks/coder.py", line 8, in encoder
    net = Convolution2D(64, 5, 5, activation='relu', border_mode='same')(net)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 572, in __call__
    self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 635, in add_inbound_node
    Node.create_node(self, inbound_layers, node_indices, tensor_indices)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 166, in create_node
    output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 475, in call
    filter_shape=self.W_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2691, in conv2d
    x = tf.nn.conv2d(x, kernel, strides, padding=padding)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 631, in conv2d
    data_format=data_format, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10,160,240,64]
	 [[Node: Conv2D = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](_arg_input_1_0_0/_241, convolution2d_1_W/read)]]

/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
train folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001']
Generating filenames
Traceback (most recent call last):
  File "main_soft.py", line 434, in <module>
    main()
  File "main_soft.py", line 331, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator_soft.py", line 92, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), batch_size)
NameError: name 'VAE' is not defined
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
train folders:  ['/home/ml1323/project/robert_data/DISFA/kshot/0/SN001']
Generating filenames
Traceback (most recent call last):
  File "main_soft.py", line 434, in <module>
    main()
  File "main_soft.py", line 331, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator_soft.py", line 92, in make_data_tensor
    vae_model = VAE((self.img_size[0], self.img_size[1], 1), batch_size)
NameError: name 'VAE' is not defined
10
train_iter.sh: 16: train_iter.sh: [[: not found
10
train_iter.sh: 20: train_iter.sh: cannot create logs/out/10shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
20
train_iter.sh: 16: train_iter.sh: [[: not found
20
train_iter.sh: 20: train_iter.sh: cannot create logs/out/20shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
30
train_iter.sh: 16: train_iter.sh: [[: not found
30
train_iter.sh: 20: train_iter.sh: cannot create logs/out/30shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
40
train_iter.sh: 16: train_iter.sh: [[: not found
40
train_iter.sh: 20: train_iter.sh: cannot create logs/out/40shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
50
train_iter.sh: 16: train_iter.sh: [[: not found
50
train_iter.sh: 20: train_iter.sh: cannot create logs/out/50shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
10
train_iter.sh: 16: train_iter.sh: [[: not found
10
train_iter.sh: 20: train_iter.sh: cannot create logs/out/10shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
20
train_iter.sh: 16: train_iter.sh: [[: not found
20
train_iter.sh: 20: train_iter.sh: cannot create logs/out/20shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
30
train_iter.sh: 16: train_iter.sh: [[: not found
30
train_iter.sh: 20: train_iter.sh: cannot create logs/out/30shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
40
train_iter.sh: 16: train_iter.sh: [[: not found
40
train_iter.sh: 20: train_iter.sh: cannot create logs/out/40shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
50
train_iter.sh: 16: train_iter.sh: [[: not found
50
train_iter.sh: 20: train_iter.sh: cannot create logs/out/50shot.uplr0.005.num_up5.metalr0.005.init_weightFalse.meta_batch_size14/train.txt: Directory nonexistent
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
/home/mihee/dev/project/robert_data/test.h5
Traceback (most recent call last):
  File "train_deep_coder_disfa.py", line 42, in <module>
    TR = ED.provider_back.flow_from_hdf5(args.training_data, batch_size, padding='same')
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/provider_back.py", line 17, in flow_from_hdf5
    f = h5py.File(path_to_file, 'r')
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 269, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 99, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 78, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = '/home/mihee/dev/project/robert_data/test.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Traceback (most recent call last):
  File "main.py", line 30, in <module>
    from data_generator import DataGenerator
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 8, in <module>
    from utils import get_images
ModuleNotFoundError: No module named 'utils'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
usage: main.py [-h] [--datasource DATASOURCE] [--num_classes NUM_CLASSES]
               [--baseline BASELINE]
               [--pretrain_iterations PRETRAIN_ITERATIONS]
               [--metatrain_iterations METATRAIN_ITERATIONS]
               [--meta_batch_size META_BATCH_SIZE] [--meta_lr META_LR]
               [--update_batch_size UPDATE_BATCH_SIZE] [--update_lr UPDATE_LR]
               [--num_updates NUM_UPDATES] [--stop_grad [STOP_GRAD]]
               [--nostop_grad] [--log [LOG]] [--nolog] [--datadir DATADIR]
               [--valdir VALDIR] [--logdir LOGDIR] [--resume [RESUME]]
               [--noresume] [--train [TRAIN]] [--notrain]
               [--test_iter TEST_ITER] [--num_test_pts NUM_TEST_PTS]
               [--test_set [TEST_SET]] [--notest_set]
               [--subject_idx SUBJECT_IDX]
               [--train_update_batch_size TRAIN_UPDATE_BATCH_SIZE]
               [--train_update_lr TRAIN_UPDATE_LR]
               [--init_weight [INIT_WEIGHT]] [--noinit_weight]
               [--train_test [TRAIN_TEST]] [--notrain_test]
               [--train_test_inc [TRAIN_TEST_INC]] [--notrain_test_inc]
               [--test_test [TEST_TEST]] [--notest_test]
               [--test_train [TEST_TRAIN]] [--notest_train]
               [--train_start_idx TRAIN_START_IDX]
               [--test_start_idx TEST_START_IDX] [--test_num TEST_NUM]
               [--testset_dir TESTSET_DIR] [--test_result_dir TEST_RESULT_DIR]
               [--keep_train_dir KEEP_TRAIN_DIR] [--local_subj LOCAL_SUBJ]
               [--kshot_seed KSHOT_SEED] [--weight_seed WEIGHT_SEED]
               [--vae_model VAE_MODEL]
main.py: error: argument --kshot_seed: invalid int value: ''
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032']
Generating filenames
>>>> all_filenames:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame765.jpg'
 '/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame768.jpg']
>>>>>>>>>>>>>>>>> vae_model:  ./model_soft_80.h5
>>>>>>>>>>>>>>>>>> random seed for kshot:  3
>>>>>>>>>>>>>>>>>> random seed for weight:  3
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-30 19:33:50.764090: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-07-30 19:34:03.408188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-07-30 19:34:03.607685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-07-30 19:34:03.822044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-07-30 19:34:04.037926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-07-30 19:34:04.038484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-07-30 19:34:04.038542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-07-30 19:34:04.038548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-07-30 19:34:04.038552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-07-30 19:34:04.038555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-07-30 19:34:04.038558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-07-30 19:34:04.038574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-30 19:34:04.038579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-30 19:34:04.038583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-30 19:34:04.038586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-07-30 19:34:08.272023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-07-30 19:34:08.272058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-07-30 19:34:08.272063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-07-30 19:34:08.272067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
>>>>> trained_model_dir:  logs/disfa/au12_one/kshot/seed3//cls_2.mbs_14.ubs_1.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:13.ubs_1.numstep5.updatelr0.005.metalr0.005
========================================================================================
initial weights:  [[[ 0.01473885 -0.00620508]]

 [[ 0.01402452  0.01683451]]

 [[-0.01410421  0.00970514]]

 ...

 [[ 0.01113014  0.01621145]]

 [[-0.01858313 -0.02714167]]

 [[-0.00862169  0.00109578]]] [[-0.7084177   0.46176124]]
weights from vae :  [array([[[ 0.149691  , -0.06038365]],

       [[ 0.19451092, -0.04562005]],

       [[-0.00595228, -0.18083908]],

       ...,

       [[-0.0237594 ,  0.02594686]],

       [[ 0.02871932, -0.13068329]],

       [[-0.00353112, -0.06629411]]], dtype=float32), array([[ 0.0005561, -0.0005561]], dtype=float32)]
updated weights from vae?:  False [[[ 0.01473885 -0.00620508]]

 [[ 0.01402452  0.01683451]]

 [[-0.01410421  0.00970514]]

 ...

 [[ 0.01113014  0.01621145]]

 [[-0.01858313 -0.02714167]]

 [[-0.00862169  0.00109578]]] [[-0.7084177   0.46176124]]
========================================================================================
>>>> model_file1:  logs/disfa/au12_one/kshot/seed3//cls_2.mbs_14.ubs_1.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:13.ubs_1.numstep5.updatelr0.005.metalr0.005/model20000
Restoring model weights from logs/disfa/au12_one/kshot/seed3//cls_2.mbs_14.ubs_1.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:13.ubs_1.numstep5.updatelr0.005.metalr0.005/model20000
updated weights from ckpt:  [[[ 0.24114758 -0.28075433]]

 [[ 0.43872613 -0.38067979]]

 [[ 0.32678506 -0.32278824]]

 ...

 [[-0.62550503  0.62730873]]

 [[ 0.4338668  -0.45580745]]

 [[ 0.23434438 -0.21022776]]] [[-1.31032062  0.66060883]]
=====================================================================================
Tensor("MaxPool_7:0", shape=(?, 10, 15, 16), dtype=float32)
loaded weight from robert :  [[[ 0.149691   -0.06038365]]

 [[ 0.19451092 -0.04562005]]

 [[-0.00595228 -0.18083908]]

 ...

 [[-0.0237594   0.02594686]]

 [[ 0.02871932 -0.13068329]]

 [[-0.00353112 -0.06629411]]] [[ 0.0005561 -0.0005561]]
loaded weight from maml :  [[[ 0.24114758 -0.28075433]]

 [[ 0.43872613 -0.3806798 ]]

 [[ 0.32678506 -0.32278824]]

 ...

 [[-0.62550503  0.6273087 ]]

 [[ 0.4338668  -0.45580745]]

 [[ 0.23434438 -0.21022776]]] [[-1.3103206  0.6606088]]
test_subjects:  ['SN017.pkl', 'SN018.pkl', 'SN021.pkl', 'SN023.pkl', 'SN024.pkl', 'SN025.pkl', 'SN026.pkl', 'SN027.pkl', 'SN028.pkl', 'SN029.pkl', 'SN030.pkl', 'SN031.pkl', 'SN032.pkl']
SN017  original total len: 4645
SN017  rounded down total len: 4640
Exception in thread Thread-7:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'

Exception in thread Thread-14:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'
Exception in thread Thread-6:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'

Exception in thread Thread-5:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'
Exception in thread Thread-12:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'

Exception in thread Thread-9:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'



Exception in thread Thread-8:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'
Exception in thread Thread-10:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'

Exception in thread Thread-11:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'


Exception in thread Thread-13:
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/home/ml1323/anaconda3/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 155, in _target
    out = self.transform(sample, *args, **kwargs)
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 62, in transform
    img = gray2rgb(img)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/color/colorconv.py", line 852, in gray2rgb
    elif image.ndim != 1 and dims in (1, 2, 3):
AttributeError: 'NoneType' object has no attribute 'ndim'

Traceback (most recent call last):
  File "main.py", line 471, in <module>
    main()
  File "main.py", line 457, in main
    test_test(w, b, trained_model_dir)
  File "main.py", line 333, in test_test
    y_hat = get_y_hat(test_file_names, N_batch)
  File "main.py", line 313, in get_y_hat
    pred = predict_label(file_path)
  File "main.py", line 306, in predict_label
    return vae_model.testWithSavedModel(img_arr)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 73, in testWithSavedModel
    z, pred = self.model_z_int.predict(x, batch_size=len(x))
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1254, in predict
    check_batch_axis=False)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 112, in standardize_input_data
    str(array.shape))
ValueError: Error when checking : expected input_2 to have 4 dimensions, but got array with shape (10, 1)
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032']
Generating filenames
>>>> all_filenames:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame765.jpg'
 '/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame768.jpg']
>>>>>>>>>>>>>>>>> vae_model:  ./model_soft_80.h5
>>>>>>>>>>>>>>>>>> random seed for kshot:  3
>>>>>>>>>>>>>>>>>> random seed for weight:  3
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-07-30 19:34:31.145963: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032']
Generating filenames
>>>> inputa_files:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/off/frame1456.jpg', '/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame263.jpg']
--------------------------------------------
>>>> inputb_files:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/off/frame4519.jpg', '/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame253.jpg']
>>>>>>>>>>>>>>>>> vae_model:  ./model_soft_80.h5
>>>>>>>>>>>>>>>>>> random seed for kshot:  2
>>>>>>>>>>>>>>>>>> random seed for weight:  0
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
2018-08-03 15:11:07.477181: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-08-03 15:11:08.106998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-03 15:11:08.370911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-03 15:11:08.638210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:8a:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-03 15:11:09.288232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:8b:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-03 15:11:09.291929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-08-03 15:11:09.292136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-08-03 15:11:09.292149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y Y Y 
2018-08-03 15:11:09.292158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y Y Y 
2018-08-03 15:11:09.292166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   Y Y Y Y 
2018-08-03 15:11:09.292173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   Y Y Y Y 
2018-08-03 15:11:09.292196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-08-03 15:11:09.292208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-08-03 15:11:09.292217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:8a:00.0, compute capability: 3.7)
2018-08-03 15:11:09.292226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:8b:00.0, compute capability: 3.7)
2018-08-03 15:11:31.728085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-08-03 15:11:31.771618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
2018-08-03 15:11:31.771632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:8a:00.0, compute capability: 3.7)
2018-08-03 15:11:31.771638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:8b:00.0, compute capability: 3.7)
>>>>> trained_model_dir:  logs/disfa/au12/kshot/seed2//cls_2.mbs_14.ubs_10.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:1.ubs_10.numstep5.updatelr0.005.metalr0.005
========================================================================================
initial weights:  [[[-0.02542669  0.02753444]]

 [[ 0.01402315 -0.03037427]]

 [[ 0.02327837  0.02685055]]

 ...

 [[-0.01946094  0.00805596]]

 [[ 0.00700356  0.02701524]]

 [[-0.02251183  0.00504371]]] [[-1.0246947  0.6322087]]
weights from vae :  [array([[[ 0.149691  , -0.06038365]],

       [[ 0.19451092, -0.04562005]],

       [[-0.00595228, -0.18083908]],

       ...,

       [[-0.0237594 ,  0.02594686]],

       [[ 0.02871932, -0.13068329]],

       [[-0.00353112, -0.06629411]]], dtype=float32), array([[ 0.0005561, -0.0005561]], dtype=float32)]
updated weights from vae?:  False [[[-0.02542669  0.02753444]]

 [[ 0.01402315 -0.03037427]]

 [[ 0.02327837  0.02685055]]

 ...

 [[-0.01946094  0.00805596]]

 [[ 0.00700356  0.02701524]]

 [[-0.02251183  0.00504371]]] [[-1.0246947  0.6322087]]
========================================================================================
>>>> model_file1:  None
Tensor("MaxPool_7:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
loaded weight from robert :  [[[ 0.149691   -0.06038365]]

 [[ 0.19451092 -0.04562005]]

 [[-0.00595228 -0.18083908]]

 ...

 [[-0.0237594   0.02594686]]

 [[ 0.02871932 -0.13068329]]

 [[-0.00353112 -0.06629411]]] [[ 0.0005561 -0.0005561]]
test_subjects:  ['SN017.pkl']
SN017  original total len: 4645
SN017  rounded down total len: 4640
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 119, in make_fid
    fid = h5f.open(name, h5f.ACC_RDWR, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 78, in h5py.h5f.open
OSError: Unable to open file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 122, in make_fid
    fid = h5f.open(name, h5f.ACC_RDONLY, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 78, in h5py.h5f.open
OSError: Unable to open file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 30, in <module>
    from data_generator import DataGenerator
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 10, in <module>
    import EmoData as ED
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/__init__.py", line 2, in <module>
    from . import image_pipeline
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_pipeline.py", line 11, in <module>
    from .image_processing import bbox_extractor, save_image, add_landmarks_to_img 
  File "/gpu/homedirs/ml1323/project/robert_code/EmoData/image_processing.py", line 14, in <module>
    with h5py.File(os.path.dirname(__file__)+'/data/mean_shape.h5') as tmp:
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 269, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/_hl/files.py", line 124, in make_fid
    fid = h5f.create(name, h5f.ACC_EXCL, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to open file: name = '/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5', errno = 17, error message = 'File exists', flags = 15, o_flags = c2)
y_hat: 
[0 1 0 ... 0 1 1]
y_lab: 
[0 1 0 ... 1 1 1]
        0  avr.
ICC  0.62  0.62
PCC  0.63  0.63
RMSE 0.45  0.45
MAE  0.20  0.20
ACC  0.80  0.80
F1-b 0.73  0.73

=======================================================
>>>>>> elapse time: 0:07:41.655860
=======================================================
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
/gpu/homedirs/ml1323/proje/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032']
Generating filenames
>>>> inputa_files:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/off/frame2433.jpg', '/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame602.jpg']
--------------------------------------------
>>>> inputb_files:  ['/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/off/frame2967.jpg', '/home/ml1323/project/robert_data/DISFA/kshot_rest/au12/kshot/SN032/on/frame1364.jpg']
>>>>>>>>>>>>>>>>> vae_model:  ./model_auall.h5
>>>>>>>>>>>>>>>>>> random seed for kshot:  0
>>>>>>>>>>>>>>>>>> random seed for weight:  0
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
2018-08-04 20:17:37.881255: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: S2018-08-04 20:19:55.256973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0a:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-04 20:19:55.439410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:0b:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-04 20:19:55.628065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:86:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-04 20:19:55.830117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:87:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-04 20:19:55.830758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-08-04 20:19:55.830836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-08-04 20:19:55.830844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-08-04 20:19:55.830849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-08-04 20:19:55.830853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-08-04 20:19:55.830858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-08-04 20:19:55.830871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-08-04 20:19:55.830878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-08-04 20:19:55.830883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-08-04 20:19:55.830888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
>>>>>>>>>>>>>> au_idx in  ./model_auall.h5:  0
>>>>>>>>>>>>>> au_idx in  ./model_auall.h5:  0
2018-08-04 20:20:00.766463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:0a:00.0, compute capability: 3.7)
2018-08-04 20:20:00.766503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:0b:00.0, compute capability: 3.7)
2018-08-04 20:20:00.766508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:86:00.0, compute capability: 3.7)
2018-08-04 20:20:00.766517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:87:00.0, compute capability: 3.7)
>>>>> trained_model_dir:  logs/disfa/au12_all/kshot/seed0//cls_2.mbs_14.ubs_10.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:13.ubs_10.numstep5.updatelr0.005.metalr0.005
========================================================================================
initial weights:  [[[-0.02542669  0.02753444]]

 [[ 0.01402315 -0.03037427]]

 [[ 0.02327837  0.02685055]]

 ...

 [[-0.01946094  0.00805596]]

 [[ 0.00700356  0.02701524]]

 [[-0.02251183  0.00504371]]] [[-1.0246947  0.6322087]]
weights from vae :  [array([[[ 0.02462824, -0.08299077]],

       [[-0.07688708, -0.16187066]],

       [[ 0.02724542,  0.00314786]],

       ...,

       [[-0.03604874, -0.07842484]],

       [[ 0.04195155,  0.07180326]],

       [[-0.02001986, -0.00285338]]], dtype=float32), array([[ 0.00135317, -0.00135322]], dtype=float32)]
updated weights from vae?:  False [[[-0.02542669  0.02753444]]

 [[ 0.01402315 -0.03037427]]

 [[ 0.02327837  0.02685055]]

 ...

 [[-0.01946094  0.00805596]]

 [[ 0.00700356  0.02701524]]

 [[-0.02251183  0.00504371]]] [[-1.0246947  0.6322087]]
========================================================================================
>>>> model_file1:  logs/disfa/au12_all/kshot/seed0//cls_2.mbs_14.ubs_10.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:13.ubs_10.numstep5.updatelr0.005.metalr0.005/model30000
Restoring model weights from logs/disfa/au12_all/kshot/seed0//cls_2.mbs_14.ubs_10.numstep5.updatelr0.005.metalr0.005.initweightFalse/sbjt14:13.ubs_10.numstep5.updatelr0.005.metalr0.005/model30000
alr0.005/model20000
updated weights from ckpt:  [[[ 0.16036424 -0.15238796]]

 [[ 0.49006853 -0.43626237]]

 [[-0.06452243  0.20258895]]

 ...

 [[ 0.02019243  0.00190818]]

 [[-0.14823008  0.24105623]]

 [[ 0.05246125  0.10152524]]] [[-0.74395579 -0.8161158 ]]
=====================================================================================
Tensor("MaxPool_7:0", shape=(?, 10, 15, 16), dtype=float32)
loaded weight from robert :  [[[ 0.02462824 -0.08299077]
  [ 0.06351455  0.11979692]
  [-0.07914159 -0.11215924]]

 [[-0.07688708 -0.16187066]
  [-0.01045114 -0.14458475]
  [ 0.17904718  0.05485323]]

 [[ 0.02724542  0.00314786]
  [ 0.09433948  0.13078311]
  [-0.23245291 -0.00473161]]

 ...

 [[-0.03604874 -0.07842484]
  [-0.00765849  0.03996092]
  [-0.03572885 -0.09805186]]

 [[ 0.04195155  0.07180326]
  [-0.03753585 -0.10339776]
  [-0.04988011  0.20795068]]

 [[-0.02001986 -0.00285338]
  [ 0.09631255  0.02530505]
  [-0.22743331  0.13678962]]] [[ 0.00135317 -0.00135322]
 [ 0.00205717 -0.00205723]
 [ 0.00436292 -0.0043631 ]]
loaded weight from maml :  [[[ 0.16036424 -0.15238796]
  [ 0.16036424 -0.15238796]
  [ 0.16036424 -0.15238796]]

 [[ 0.49006853 -0.43626237]
  [ 0.49006853 -0.43626237]
  [ 0.49006853 -0.43626237]]

 [[-0.06452243  0.20258895]
  [-0.06452243  0.20258895]
  [-0.06452243  0.20258895]]

 ...

 [[ 0.02019243  0.00190818]
  [ 0.02019243  0.00190818]
  [ 0.02019243  0.00190818]]

 [[-0.14823008  0.24105623]
  [-0.14823008  0.24105623]
  [-0.14823008  0.24105623]]

 [[ 0.05246125  0.10152524]
  [ 0.05246125  0.10152524]
  [ 0.05246125  0.10152524]]] [[-0.7439558 -0.8161158]
 [-0.7439558 -0.8161158]
 [-0.7439558 -0.8161158]]
test_subjects:  ['SN017.pkl', 'SN018.pkl', 'SN021.pkl', 'SN023.pkl', 'SN024.pkl', 'SN025.pkl', 'SN026.pkl', 'SN027.pkl', 'SN028.pkl', 'SN029.pkl', 'SN030.pkl', 'SN031.pkl', 'SN032.pkl']
SN017  original total len: 4645
SN017  rounded down total len: 4640
updated weights from ckpt:  [[[ 0.60245121  0.16318758]]

 [[ 1.40500367 -0.61614138]]

 [[-0.50901926  0.90884507]]

 ...

 [[-0.90454531 -0.08130278]]

 [[-0.4186922   0.40698224]]

 [[-0.54240239  1.04765594]]] [[-1.38946104 -1.35205126]]
=====================================================================================
Tensor("MaxPool_7:0", shape=(?, 10, 15, 16), dtype=float32)
loaded weight from robert :  [[[ 0.02462824 -0.08299077]
  [ 0.06351455  0.11979692]
  [-0.07914159 -0.11215924]]

 [[-0.07688708 -0.16187066]
  [-0.01045114 -0.14458475]
  [ 0.17904718  0.05485323]]

 [[ 0.02724542  0.00314786]
  [ 0.09433948  0.13078311]
  [-0.23245291 -0.00473161]]

 ...

 [[-0.03604874 -0.07842484]
  [-0.00765849  0.03996092]
  [-0.03572885 -0.09805186]]

 [[ 0.04195155  0.07180326]
  [-0.03753585 -0.10339776]
  [-0.04988011  0.20795068]]

 [[-0.02001986 -0.00285338]
  [ 0.09631255  0.02530505]
  [-0.22743331  0.13678962]]] [[ 0.00135317 -0.00135322]
 [ 0.00205717 -0.00205723]
 [ 0.00436292 -0.0043631 ]]
loaded weight from maml :  [[[ 0.6024512   0.16318758]
  [ 0.6024512   0.16318758]
  [ 0.6024512   0.16318758]]

 [[ 1.4050037  -0.6161414 ]
  [ 1.4050037  -0.6161414 ]
  [ 1.4050037  -0.6161414 ]]

 [[-0.50901926  0.90884507]
  [-0.50901926  0.90884507]
  [-0.50901926  0.90884507]]

 ...

 [[-0.9045453  -0.08130278]
  [-0.9045453  -0.08130278]
  [-0.9045453  -0.08130278]]

 [[-0.4186922   0.40698224]
  [-0.4186922   0.40698224]
  [-0.4186922   0.40698224]]

 [[-0.5424024   1.0476559 ]
  [-0.5424024   1.0476559 ]
  [-0.5424024   1.0476559 ]]] [[-1.389461  -1.3520513]
 [-1.389461  -1.3520513]
 [-1.389461  -1.3520513]]
test_subjects:  ['SN017.pkl', 'SN018.pkl', 'SN021.pkl', 'SN023.pkl', 'SN024.pkl', 'SN025.pkl', 'SN026.pkl', 'SN027.pkl', 'SN028.pkl', 'SN029.pkl', 'SN030.pkl', 'SN031.pkl', 'SN032.pkl']
SN017  original total len: 4645
SN017  rounded down total len: 4640
/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/lib/function_base.py:3183: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[:, None]
/home/ml1323/anaconda3/lib/python3.6/site-packages/numpy/lib/function_base.py:3184: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[None, :]
y_hat: 
[1 1 1 ... 1 1 1]
y_lab: 
[0 1 0 ... 1 1 1]
        0  avr.
ICC  0.00  0.00
PCC  0.00  0.00
RMSE 0.74  0.74
MAE  0.54  0.54
ACC  0.46  0.46
F1-b 0.63  0.63

SN018  original total len: 4645
SN018  rounded down total len: 4640
y_hat: 
[0 0 0 ... 0 0 0]
y_lab: 
[0 0 0 ... 0 0 0]
        0  avr.
ICC  0.80  0.80
PCC  0.81  0.81
RMSE 0.29  0.29
MAE  0.08  0.08
ACC  0.92  0.92
F1-b 0.84  0.84

SN021  original total len: 4645
SN021  rounded down total len: 4640
y_hat: 
[0 0 1 ... 0 0 0]
y_lab: 
[0 0 0 ... 0 0 0]
        0  avr.
ICC  0.43  0.43
PCC  0.45  0.45
RMSE 0.59  0.59
MAE  0.34  0.34
ACC  0.66  0.66
F1-b 0.51  0.51

SN023  original total len: 4630
SN023  rounded down total len: 4630
y_hat: 
[0 1 1 ... 0 1 0]
y_lab: 
[0 0 0 ... 0 0 0]
        0  avr.
ICC  0.49  0.49
PCC  0.50  0.50
RMSE 0.54  0.54
MAE  0.30  0.30
ACC  0.70  0.70
F1-b 0.57  0.57

SN024  original total len: 4645
SN024  rounded down total len: 4640
y_hat: 
[0 0 0 ... 0 0 0]
y_lab: 
[0 0 0 ... 0 0 0]
        0  avr.
ICC  0.60  0.60
PCC  0.60  0.60
RMSE 0.30  0.30
MAE  0.09  0.09
ACC  0.91  0.91
F1-b 0.65  0.65

SN025  original total len: 4642
SN025  rounded down total len: 4640
y_hat: 
[1 1 1 ... 0 0 0]
y_lab: 
[1 1 1 ... 0 0 0]
        0  avr.
ICC  0.68  0.68
PCC  0.68  0.68
RMSE 0.41  0.41
MAE  0.17  0.17
ACC  0.83  0.83
F1-b 0.82  0.82

SN026  original total len: 4645
SN026  rounded down total len: 4640
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
>>>>>>> test folders:  ['/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016']
Generating filenames
============================================
>>>>>>>>>>>>>subject:  6
-------------------------------
validate:  True
label:  on
num of on_images:  2
-------------------------------
validate:  True
label:  off
num of off_images:  2
>>>> inputa_files:  ['/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/off/frame2234.jpg', '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/on/frame526.jpg']
--------------------------------------------
>>>> inputb_files:  ['/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/off/frame2675.jpg', '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/on/frame746.jpg']
>>> labelas:  [0, 1]
>>>>>>>>>>>>>>>>> vae_model:  ./model_au_12.h5
>>>>>>>>>>>>>>>>>> random seed for kshot:  0
>>>>>>>>>>>>>>>>>> random seed for weight:  0
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/gpu/homedirs/ml1323/project/robert_code/EmoData/data/mean_shape.h5
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
>>>>>>> test folders:  ['/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016']
Generating filenames
============================================
>>>>>>>>>>>>>subject:  6
-------------------------------
validate:  True
label:  on
num of on_images:  2
-------------------------------
validate:  True
label:  off
num of off_images:  2
>>>> inputa_files:  ['/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/off/frame2234.jpg', '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/on/frame526.jpg']
--------------------------------------------
>>>> inputb_files:  ['/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/off/frame2675.jpg', '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au12/SN016/on/frame746.jpg']
>>> labelas:  [0, 1]
>>>>>>>>>>>>>>>>> vae_model:  ./model_au_12.h5
>>>>>>>>>>>>>>>>>> random seed for kshot:  0
>>>>>>>>>>>>>>>>>> random seed for weight:  0
Tensor("MaxPool_3:0", shape=(?, 10, 15, 16), dtype=float32)
/home/ml1323/anaconda3/lib/python3.6/site-packages/skimage/exposure/exposure.py:63: UserWarning: This might be a color image. The histogram will be computed on the flattened image. You can instead apply this function to each color channel.
  warn("This might be a color image. The histogram will be "
Traceback (most recent call last):
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 686, in _call_cpp_shape_fn_impl
    input_tensors_as_shapes, status)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimension 1 in both shapes must be equal, but are 12 and 3 for 'Assign_58' (op: 'Assign') with input shapes: [2000,12,2], [2000,3,2].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 446, in <module>
    main()
  File "main.py", line 325, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 125, in make_data_tensor
    inputa_latent_feat, self.pred_weights = latent_feature(inputa_files)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 117, in latent_feature
    weights, z = vae_model.computeLatentVal(img_arr, FLAGS.vae_model, FLAGS.au_idx)
  File "/gpu/homedirs/ml1323/project/robert_code/vae_model.py", line 58, in computeLatentVal
    self.model_train.load_weights(vae_model)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 2708, in load_weights
    self.load_weights_from_hdf5_group(f)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 2794, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 1876, in batch_set_value
    assign_op = x.assign(assign_placeholder)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 573, in assign
    return state_ops.assign(self._variable, value, use_locking=use_locking)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 276, in assign
    validate_shape=validate_shape)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 57, in assign
    use_locking=use_locking, name=name)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/common_shapes.py", line 691, in _call_cpp_shape_fn_impl
    raise ValueError(err.message)
ValueError: Dimension 1 in both shapes must be equal, but are 12 and 3 for 'Assign_58' (op: 'Assign') with input shapes: [2000,12,2], [2000,3,2].
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_deep_coder_disfa.py", line 1, in <module>
    import EmoEstimator as EE
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/__init__.py", line 1, in <module>
    from . import callbacks 
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/callbacks/__init__.py", line 1, in <module>
    from .summary_multi_output import summary_multi_output
  File "/gpu/homedirs/ml1323/project/robert_code/EmoEstimator/callbacks/summary_multi_output.py", line 3, in <module>
    from keras import backend as K
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/__init__.py", line 4, in <module>
    from . import engine
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/__init__.py", line 3, in <module>
    from .topology import InputSpec
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 17, in <module>
    from ..utils.io_utils import ask_to_proceed_with_overwrite
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/keras/utils/io_utils.py", line 15, in <module>
    import tables
  File "/home/ml1323/anaconda3/lib/python3.6/site-packages/tables/__init__.py", line 90, in <module>
    from .utilsextension import (
  File "tables/utilsextension.pyx", line 349, in init tables.utilsextension
  File "tables/_comp_bzip2.pyx", line 3, in init tables._comp_bzip2
  File "<frozen importlib._bootstrap>", line 966, in _find_and_load
KeyboardInterrupt
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "test.py", line 537, in <module>
    main()
  File "test.py", line 255, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 37, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
>>>>>>> test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_path/train/au1/SN001']
Generating filenames
============================================
kshot_path:  /home/ml1323/project/robert_data/DISFA/kshot_path/train/au1/SN001
subject:  SN001
feature_file_path:  /SN001.csv
Traceback (most recent call last):
  File "test.py", line 306, in <module>
    main()
  File "test.py", line 125, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 78, in make_data_tensor
    nb_samples=FLAGS.update_batch_size * 2, validate=True)
  File "/gpu/homedirs/ml1323/project/robert_code/utils.py", line 119, in get_kshot_feature
    f = open(feature_file_path, 'r')
FileNotFoundError: [Errno 2] No such file or directory: '/SN001.csv'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
>>>>>>> test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_path/train/au2/SN001']
Generating filenames
============================================
kshot_path:  /home/ml1323/project/robert_data/DISFA/kshot_path/train/au2/SN001
subject:  SN001
feature_file_path:  /SN001.csv
Traceback (most recent call last):
  File "test.py", line 306, in <module>
    main()
  File "test.py", line 125, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 78, in make_data_tensor
    nb_samples=FLAGS.update_batch_size * 2, validate=True)
  File "/gpu/homedirs/ml1323/project/robert_code/utils.py", line 119, in get_kshot_feature
    f = open(feature_file_path, 'r')
FileNotFoundError: [Errno 2] No such file or directory: '/SN001.csv'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
>>>>>>> test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_path/train/au4/SN001']
Generating filenames
============================================
kshot_path:  /home/ml1323/project/robert_data/DISFA/kshot_path/train/au4/SN001
subject:  SN001
feature_file_path:  /SN001.csv
Traceback (most recent call last):
  File "test.py", line 306, in <module>
    main()
  File "test.py", line 125, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 78, in make_data_tensor
    nb_samples=FLAGS.update_batch_size * 2, validate=True)
  File "/gpu/homedirs/ml1323/project/robert_code/utils.py", line 119, in get_kshot_feature
    f = open(feature_file_path, 'r')
FileNotFoundError: [Errno 2] No such file or directory: '/SN001.csv'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
>>>>>>> test folders:  ['/home/ml1323/project/robert_data/DISFA/kshot_path/train/au6/SN001']
Generating filenames
============================================
kshot_path:  /home/ml1323/project/robert_data/DISFA/kshot_path/train/au6/SN001
subject:  SN001
feature_file_path:  /SN001.csv
Traceback (most recent call last):
  File "test.py", line 306, in <module>
    main()
  File "test.py", line 125, in main
    inputa, inputb, labela, labelb = data_generator.make_data_tensor(train=False)
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator.py", line 78, in make_data_tensor
    nb_samples=FLAGS.update_batch_size * 2, validate=True)
  File "/gpu/homedirs/ml1323/project/robert_code/utils.py", line 119, in get_kshot_feature
    f = open(feature_file_path, 'r')
FileNotFoundError: [Errno 2] No such file or directory: '/SN001.csv'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
/home/ml1323/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
Using TensorFlow backend.
WARN: Cannot define MaxPoolGrad, likely already defined for this version of tensorflow: "Registering two gradient with name 'MaxPoolGrad' !(Previous registration was in _find_and_load_unlocked <frozen importlib._bootstrap>:955)"
Traceback (most recent call last):
  File "main2.py", line 270, in <module>
    main()
  File "main2.py", line 149, in main
    data_generator = DataGenerator()
  File "/gpu/homedirs/ml1323/project/robert_code/data_generator2.py", line 40, in __init__
    all_aus = os.listdir(data_folder)
FileNotFoundError: [Errno 2] No such file or directory: '/home/ml1323/project/robert_data/DISFA/new_dataset/train/au0/'
